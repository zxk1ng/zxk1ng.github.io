<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><div id="myscoll"></div><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>AST混淆与反混淆 | zxk1ng🍓</title><meta name="keywords" content="AST,JS逆向,爬虫,阅读"><meta name="author" content="zxk1ng"><meta name="copyright" content="zxk1ng"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="🥒阅读《反爬虫AST原理与还原混淆实战》记录的一些小东西">
<meta property="og:type" content="article">
<meta property="og:title" content="AST混淆与反混淆">
<meta property="og:url" content="https://zxk1ng.github.io/posts/95017dfa.html">
<meta property="og:site_name" content="zxk1ng🍓">
<meta property="og:description" content="🥒阅读《反爬虫AST原理与还原混淆实战》记录的一些小东西">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://api.yimian.xyz/img?type=moe&size=1920x1080">
<meta property="article:published_time" content="2025-01-15T06:54:58.000Z">
<meta property="article:modified_time" content="2025-01-15T07:14:39.049Z">
<meta property="article:author" content="zxk1ng">
<meta property="article:tag" content="AST">
<meta property="article:tag" content="JS逆向">
<meta property="article:tag" content="爬虫">
<meta property="article:tag" content="阅读">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://api.yimian.xyz/img?type=moe&size=1920x1080"><link rel="shortcut icon" href="/"><link rel="canonical" href="https://zxk1ng.github.io/posts/95017dfa"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/font-awesome/6.0.0/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.staticfile.org/fancyapps-ui/4.0.31/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: zxk1ng","link":"链接: ","source":"来源: zxk1ng🍓","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdnjs.cloudflare.com/ajax/libs/flickr-justified-gallery/2.1.2/fjGallery.min.js',
      css: 'https://cdnjs.cloudflare.com/ajax/libs/flickr-justified-gallery/2.1.2/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'AST混淆与反混淆',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-01-15 15:14:39'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="https://cdn1.tianli0.top/npm/element-ui@2.15.6/packages/theme-chalk/lib/index.css"><style id="themeColor"></style><style id="rightSide"></style><style id="transPercent"></style><style id="blurNum"></style><style id="settingStyle"></style><span id="fps"></span><style id="defineBg"></style><style id="menu_shadow"></style><svg aria-hidden="true" style="position:absolute; overflow:hidden; width:0; height:0"><symbol id="icon-sun" viewBox="0 0 1024 1024"><path d="M960 512l-128 128v192h-192l-128 128-128-128H192v-192l-128-128 128-128V192h192l128-128 128 128h192v192z" fill="#FFD878" p-id="8420"></path><path d="M736 512a224 224 0 1 0-448 0 224 224 0 1 0 448 0z" fill="#FFE4A9" p-id="8421"></path><path d="M512 109.248L626.752 224H800v173.248L914.752 512 800 626.752V800h-173.248L512 914.752 397.248 800H224v-173.248L109.248 512 224 397.248V224h173.248L512 109.248M512 64l-128 128H192v192l-128 128 128 128v192h192l128 128 128-128h192v-192l128-128-128-128V192h-192l-128-128z" fill="#4D5152" p-id="8422"></path><path d="M512 320c105.888 0 192 86.112 192 192s-86.112 192-192 192-192-86.112-192-192 86.112-192 192-192m0-32a224 224 0 1 0 0 448 224 224 0 0 0 0-448z" fill="#4D5152" p-id="8423"></path></symbol><symbol id="icon-moon" viewBox="0 0 1024 1024"><path d="M611.370667 167.082667a445.013333 445.013333 0 0 1-38.4 161.834666 477.824 477.824 0 0 1-244.736 244.394667 445.141333 445.141333 0 0 1-161.109334 38.058667 85.077333 85.077333 0 0 0-65.066666 135.722666A462.08 462.08 0 1 0 747.093333 102.058667a85.077333 85.077333 0 0 0-135.722666 65.024z" fill="#FFB531" p-id="11345"></path><path d="M329.728 274.133333l35.157333-35.157333a21.333333 21.333333 0 1 0-30.165333-30.165333l-35.157333 35.157333-35.114667-35.157333a21.333333 21.333333 0 0 0-30.165333 30.165333l35.114666 35.157333-35.114666 35.157334a21.333333 21.333333 0 1 0 30.165333 30.165333l35.114667-35.157333 35.157333 35.157333a21.333333 21.333333 0 1 0 30.165333-30.165333z" fill="#030835" p-id="11346"></path></symbol></svg><!-- hexo injector head_end start --><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/font-awesome-animation.min.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/tag_plugins.css" media="defer" onload="this.media='all'"><script src="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@latest/lib/assets/carousel-touch.js"></script><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload="this.media='screen'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="zxk1ng🍓" type="application/atom+xml">
</head><body><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><div class="loading-img"></div><div class="loading-image-dot"></div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/img.png" onerror="onerror=null;src='/assets/r1.jpg'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">12</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">19</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-home"></use></svg><span class="menu_word" style="font-size:17px"> 首页</span></a></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon--article"></use></svg><span class="menu_word" style="font-size:17px"> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-guidang1">                   </use></svg><span class="menu_word" style="font-size:17px"> 归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-sekuaibiaoqian">                   </use></svg><span class="menu_word" style="font-size:17px"> 标签</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-fenlei">                   </use></svg><span class="menu_word" style="font-size:17px"> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-xiangzi"></use></svg><span class="menu_word" style="font-size:17px"> 八宝箱</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/box/nav/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-zhifengche">                   </use></svg><span class="menu_word" style="font-size:17px"> 网址导航</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shejiaoxinxi"></use></svg><span class="menu_word" style="font-size:17px"> 社交</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/comments/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-liuyan">                   </use></svg><span class="menu_word" style="font-size:17px"> 留言板</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/social/link/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-lianjie">                   </use></svg><span class="menu_word" style="font-size:17px"> 友人帐</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-wangye"></use></svg><span class="menu_word" style="font-size:17px"> 网站</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/site/echarts/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shujutongji1">                   </use></svg><span class="menu_word" style="font-size:17px"> 文章统计</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-maoliang"></use></svg><span class="menu_word" style="font-size:17px"> 个人</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/personal/bb/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-qunliaotian">                   </use></svg><span class="menu_word" style="font-size:17px"> 唠叨</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/personal/about/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-paperplane">                   </use></svg><span class="menu_word" style="font-size:17px"> 关于</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">zxk1ng🍓</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-home"></use></svg><span class="menu_word" style="font-size:17px"> 首页</span></a></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon--article"></use></svg><span class="menu_word" style="font-size:17px"> 文章</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-guidang1">                   </use></svg><span class="menu_word" style="font-size:17px"> 归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-sekuaibiaoqian">                   </use></svg><span class="menu_word" style="font-size:17px"> 标签</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-fenlei">                   </use></svg><span class="menu_word" style="font-size:17px"> 分类</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-xiangzi"></use></svg><span class="menu_word" style="font-size:17px"> 八宝箱</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/box/nav/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-zhifengche">                   </use></svg><span class="menu_word" style="font-size:17px"> 网址导航</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shejiaoxinxi"></use></svg><span class="menu_word" style="font-size:17px"> 社交</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/comments/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-liuyan">                   </use></svg><span class="menu_word" style="font-size:17px"> 留言板</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/social/link/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-lianjie">                   </use></svg><span class="menu_word" style="font-size:17px"> 友人帐</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-wangye"></use></svg><span class="menu_word" style="font-size:17px"> 网站</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/site/echarts/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-shujutongji1">                   </use></svg><span class="menu_word" style="font-size:17px"> 文章统计</span></a></li></ul></div><div class="menus_item"><a class="site-page group faa-parent animated-hover hide" href="javascript:void(0);"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-maoliang"></use></svg><span class="menu_word" style="font-size:17px"> 个人</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/personal/bb/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-qunliaotian">                   </use></svg><span class="menu_word" style="font-size:17px"> 唠叨</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/personal/about/"><svg class="menu_icon faa-tada" aria-hidden="true" style="width:1.30em;height:1.30em;vertical-align:-0.15em;fill:currentColor;overflow:hidden;"><use xlink:href="#icon-paperplane">                   </use></svg><span class="menu_word" style="font-size:17px"> 关于</span></a></li></ul></div></div><center id="name-container"><a id="page-name" href="javascript:scrollToTop()">PAGE_NAME</a></center><div id="nav-right"><div id="search-button"><a class="search faa-parent animated-hover" title="检索站内任何你想要的信息"><svg class="faa-tada icon" style="height:24px;width:24px;fill:currentColor;position:relative;top:6px" aria-hidden="true"><use xlink:href="#icon-valentine_-search-love-find-heart"></use></svg><span> 搜索</span></a></div><a class="meihua faa-parent animated-hover" onclick="toggleWinbox()" title="美化设置-自定义你的风格" id="meihua-button"><svg class="faa-tada icon" style="height:26px;width:26px;fill:currentColor;position:relative;top:8px" aria-hidden="true"><use xlink:href="#icon-tupian1"></use></svg></a><a class="sun_moon faa-parent animated-hover" onclick="switchNightMode()" title="浅色和深色模式转换" id="nightmode-button"><svg class="faa-tada" style="height:25px;width:25px;fill:currentColor;position:relative;top:7px" viewBox="0 0 1024 1024"><use id="modeicon" xlink:href="#icon-moon">       </use></svg></a><div id="toggle-menu"><a><i class="fas fa-bars fa-fw"></i></a></div></div></div></nav><div id="post-info"><h1 class="post-title">AST混淆与反混淆</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><svg class="meta_icon post-meta-icon" style="width:30px;height:30px;position:relative;top:10px"><use xlink:href="#icon-rili"></use></svg><span class="post-meta-label">发表于 </span><time class="post-meta-date-created" datetime="2025-01-15T06:54:58.000Z" title="发表于 2025-01-15 14:54:58">2025-01-15</time><span class="post-meta-separator">|</span><svg class="meta_icon post-meta-icon" style="width:18px;height:18px;position:relative;top:5px"><use xlink:href="#icon-gengxin1"></use></svg><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-01-15T07:14:39.049Z" title="更新于 2025-01-15 15:14:39">2025-01-15</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><svg class="meta_icon post-meta-icon" style="width:18px;height:18px;position:relative;top:5px"><use xlink:href="#icon-biaoqian"></use></svg><a class="post-meta-categories" href="/categories/%E9%98%85%E8%AF%BB/">阅读</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><svg class="meta_icon post-meta-icon" style="width:25px;height:25px;position:relative;top:8px"><use xlink:href="#icon-charuword"></use></svg><span class="post-meta-label">字数总计:</span><span class="word-count">1.1w</span><span class="post-meta-separator">|</span><svg class="meta_icon post-meta-icon" style="width:20px;height:20px;position:relative;top:5px"><use xlink:href="#icon-shizhong"></use></svg><span class="post-meta-label">阅读时长:</span><span>38分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="AST混淆与反混淆"><svg class="meta_icon post-meta-icon" style="width:25px;height:25px;position:relative;top:5px"><use xlink:href="#icon-eye"></use></svg><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1>AST混淆与解混淆</h1>
<h1>Web网站的调试与抓包分析</h1>
<h2 id="Chrome开发者工具">Chrome开发者工具</h2>
<p>打开方式：</p>
<ul>
<li>F12</li>
<li>ctrl+shift+I组合</li>
<li>右击网页页面，点击检查</li>
<li>在右上角三个点 ==》 更多工具</li>
<li>在浏览器中新建窗口，使用上述任意方法打开开发者工具，在切回要调试的界面</li>
</ul>
<h3 id="Elements面板">Elements面板</h3>
<p>显示页面源码的DOM树，可以在这里进行增删改查。主要用来对页面进行修饰美化，它并不是源代码</p>
<p>获取源代码方式：</p>
<ul>
<li>右键 ==》查看源代码 或者 ctrl+u</li>
<li>source面板</li>
</ul>
<p>在Elements面板下断点(右击 ==》break on )</p>
<ul>
<li>子树修改：在节点子树发生修改时断点</li>
<li>属性修改：在节点属性发生修改时断点</li>
<li>移除节点：在节点被移除时发生断点</li>
</ul>
<h3 id="Console面板">Console面板</h3>
<p>点击某个节点：</p>
<ul>
<li>$0：对当前选中的节点进行引用</li>
<li>$1：对上一次选中的节点进行引用</li>
<li>以此类推 一直回溯到$4</li>
</ul>
<p>CSS选择器语法引用节点</p>
<ul>
<li>复制需要定位的节点的selector，使用document.querySelector(“路径”)</li>
<li>如果要选择所有符合CSS选择器语法的节点document.querySelectorAll</li>
</ul>
<p>观察与检查事件监听器</p>
<ul>
<li>monitorEvents()：监听目标事件信息</li>
<li>unmonitorEvents()：停止监听</li>
<li>getEventListeners()：获取DOM节点的监听器</li>
</ul>
<p>monitorEvents()第一个参数是要监听的对象，第二个参数是要监听的事件字符串或者字符串数组</p>
<p>Elements面板的Event Listeners可以看监听器</p>
<h3 id="Source面板">Source面板</h3>
<p>断点：如果表达式有多行，在其中手动一个断点，会断在下一个表达式上。</p>
<p>条件断点：表达式true才会断下</p>
<p>XHR/fetch Breakpoints：当xhr与url子串匹配时触发断点</p>
<p>如果想在xhr生命周期的某个阶段触发断点，可以在 Event Listener Breakpoints窗中查看XHR目录</p>
<h3 id="Application面板">Application面板</h3>
<p>可以查看和删除Cookie，但是不能修改Cookie值。</p>
<p>使用localstorage本地存储来存储键值对，可以在其中进行键值对的检查修改和删除操作</p>
<ul>
<li>setItem()：存储一个名称为key的值value，如果value存在就更新</li>
<li>getItem()：获取名称为key的value值，如果key不存在就null</li>
<li>removeItem()：删除名称为key的信息，</li>
<li>clear()：清空localstorage所有信息</li>
<li>key()：键的索引</li>
</ul>
<h3 id="js逆向技巧">js逆向技巧</h3>
<p>全局搜索：ctrl+shift+F</p>
<p>console插桩：条件表达式中添加console.log</p>
<p>复制console面板：</p>
<ul>
<li>copy()</li>
<li>JSON:stringify()</li>
<li>Object.toString()</li>
<li>CryptoJS.enc.Utf8.stringify() 需要在snippets添加CryptoJS加密库</li>
</ul>
<h2 id="本地覆盖">本地覆盖</h2>
<p>Chrome中</p>
<ul>
<li>source面板中切换到替换，选择要进行替换的文件夹，在网络面板中找到某个请求进行替换Save foroverrides菜单项</li>
<li>fiddler自动响应<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/posts/95017dfa.htm/image-20241112212044355.png" alt="image-20241112212044355"></li>
</ul>
<h1>爬虫与反爬虫</h1>
<p>完整爬虫流程：</p>
<ul>
<li>发起一次http请求</li>
<li>服务站点进行一次响应</li>
<li>对返回信息进行数据解析与清洗</li>
<li>数据存储到数据库或者本地文件</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/posts/95017dfa.htm/image-20241112213016930.png" alt="image-20241112213016930"></p>
<h2 id="网络请求">网络请求</h2>
<h3 id="发送请求">发送请求</h3>
<p>http请求报文主要是四部分：请求行，请求头部，空行和请求体<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/posts/95017dfa.htm/image-20241112213004971.png" alt="image-20241112213004971"></p>
<h4 id="请求行">请求行</h4>
<p>主要有作用的是：请求方法，统一资源定位符，http协议版本</p>
<p>8中请求方法</p>
<ol>
<li>GET：向目标服务器请求资源，返回实体主体</li>
<li>POST：向目标服务器发送资源，例如提交表达</li>
<li>HEAD：与get类似，不过他用于获取报头，不会返回具体内容</li>
<li>PUT：向目标服务器发送数据以覆盖指定内容</li>
<li>DELETE：请求服务器删除URL指定内容</li>
<li>OPTIONS：返回目标服务器针对特定资源的HTTP请求方法</li>
<li>TRACE：用于测试诊断，回显服务器收到的请求</li>
<li>CONNECT：HTTP1.1协议预留给能够将链接修改为管道方式的代理服务器</li>
</ol>
<p><strong>Http1.0中只有前三种请求方法</strong></p>
<p>GET用于获取网页资源，POST常用来模拟登录</p>
<p>请求行中的<strong>统一资源定位符</strong>实际上就是<strong>URL</strong></p>
<h4 id="请求头部">请求头部</h4>
<p>请求头部主要由一系列键值对组成，用来说明服务器需要的附属信息，通常反爬虫就是在请求头部里进行，检测是否包含关键键值对，如果不存在或者数据不匹配就会被判定为机器人</p>
<p>常用8个键值对</p>
<ol>
<li>Accept-Charset：客户端可以接受的字符集</li>
<li>Cookie：网站用来识别身份所用的加密键值对，需要登录才能访问的网站通常需要携带</li>
<li>Connection：表示是否需要持久连接，close代表本次响应后连接可以被关闭</li>
<li>Content-Type：请求体数据类型</li>
<li>Content-Length：请求体的长度</li>
<li>Host：请求的主机名</li>
<li>Referer：指明用户从该URL出发到达此页面，常用于防盗链技术</li>
<li>User-Agent：服务器用来识别浏览器类型，可更改这个参数达到切换计算机端与手机端的效果</li>
</ol>
<h4 id="空行">空行</h4>
<p>必须存在于http请求头部之后，也就是输入“\n\r”，他的作用在于通知目标服务器此后不会再出现请求头部，将进入请求体。</p>
<h4 id="请求体">请求体</h4>
<p>在GET方法中一般不存在请求体，请求体适用于POST方法，内容是用户在填写表单时提交的数据，他的格式是用&amp;连接的键值对，如name=test&amp;password=123。</p>
<h3 id="解析响应">解析响应</h3>
<p>返回的http响应报文包含了客户端需要的数据，一般可以通过观察报文中的一些关键信息来确认响应的实际情况，http响应报文结构：<img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/posts/95017dfa.htm/image-20241112231535605.png" alt="image-20241112231535605"></p>
<p>四个部分：状态行，响应头，空行，响应体。</p>
<p>状态行中包括状态码和状态码描述。</p>
<h4 id="响应行">响应行</h4>
<p>状态码state code主要由三位数字构成，第一位数字用来辨别响应类型，后两位用来区分</p>
<ul>
<li>1xx：服务器成功接收客户端请求，客户端可继续发请求</li>
<li>2xx：服务器成功接收请求，并着手进行处理</li>
<li>3xx：服务器要求客户端重定向</li>
<li>4xx：服务器表明客户端请求非法</li>
<li>5xx：服务器发生错误</li>
</ul>
<p>熟记的10种状态码：省略</p>
<h4 id="响应头">响应头</h4>
<p>不必对其有太多理解，偶尔观察几个键值对辅证响应状态码的描述。</p>
<ol>
<li>Location：在301或者302下返回的重定向后的url地址</li>
<li>Connect：close表示本次响应后连接将被关闭；keepalive表示长久连接，服务器会等待客户端下次请求</li>
<li>Server：服务器用来处理请求的软件信息及其版本，与http请求中User-agent类似，不过它代表服务器端信息</li>
</ol>
<h4 id="空行-2">空行</h4>
<p>响应头后必须加入“\n\r”，他的作用表示接下来进入响应体</p>
<h4 id="响应体">响应体</h4>
<h2 id="网络爬虫分类">网络爬虫分类</h2>
<p>网络爬虫分为通用网络爬虫，聚焦网络爬虫，增量式网络爬虫，深层网络爬虫</p>
<h3 id="通用网络爬虫">通用网络爬虫</h3>
<p>又叫全网爬虫，它的目标是整个互联网，爬取数据丰富，常用语搜索引擎中。往往从一个url开始，辗转爬取，最终拓展到整个网络。</p>
<p>深度优先爬取策略和广度优先爬取策略较为常见</p>
<ul>
<li>深度优先爬取策略：按照页面深度进行排序，一次访问一级URL，直到触底无法深入</li>
<li>广度优先爬取策略：按照页面内容目录层次进行划分，爬取完同一层次的URL才会继续下一层进行爬取</li>
</ul>
<h3 id="聚焦网络爬虫">聚焦网络爬虫</h3>
<p>更适用于日常爬虫的需要，并不需要爬取整个互联网数据，它专注于某一主题，选择性的爬取网页上与开发者定义的规则相匹配的数据资源</p>
<p>四种爬取策略</p>
<ol>
<li>基于内容评价：将用户输入的信息作为主题进行爬取，页面包含用户输入信息则认为与主题有关</li>
<li>基于链接评价：根据页面结构信息分析爬取的url的重要性，根据重要程度进行爬取优先级的排序</li>
<li>基于增强学习：利用概率统计中的贝叶斯分类器，根据网页内容和链接文本对URL进行分类，计算出URL的权重，来决定爬取顺序</li>
<li>基于语境图：结合机器学习系统，计算当前页面到相关的页面的距离，距离越近的页面的URL则越优先访问</li>
</ol>
<h3 id="增量式网络爬出">增量式网络爬出</h3>
<p>主要目的是长久的维持一个数据库，对数据的稳健性和实时性具有高要求，再次爬取时就会只爬取新出现的或者发生改变的数据，对于没有发生变化的页面或者数据不会爬取</p>
<p>三种常用策略</p>
<ol>
<li>统一更新：每隔一段时间将所有页面再访问一遍，以达到更新数据的目的</li>
<li>个体更新：根据个体网站的数据变化频率来指定重新访问时间</li>
<li>分类更新：将网页区分为数据变化迅速的和数据变化缓慢的，以不同频率访问这两类网页</li>
</ol>
<h3 id="深层网络爬虫">深层网络爬虫</h3>
<p>主要指的是没法直接访问的页面，这类页面信息通常要满足一定的要求才可以浏览，他隐藏在一些表单之后，不能通过静态链接直接获取。例如一些必须登录，注册后才能访问的网站。这类爬虫只需要搭配get和post请求就可以访问，难点在于破解post提交信息时的网页数据加密</p>
<p>两种策略</p>
<ol>
<li>基于领域知识：维护一个本地的词库，通过语义分析来选取合适的关键词填写表单</li>
<li>基于网页结构分析：在领域知识欠缺的情况下，根据网页结构进行分析，并自动填写表单</li>
</ol>
<h2 id="编写网络爬虫">编写网络爬虫</h2>
<h3 id="requests请求库使用">requests请求库使用</h3>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url=<span class="string">&quot;http://www.baidu.com/&quot;</span></span><br><span class="line"></span><br><span class="line">headers=&#123;<span class="string">&quot;user-agent&quot;</span>:</span><br><span class="line"><span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36&quot;</span>&#125;</span><br><span class="line">response=requests.get(url,headers=headers)</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure>
<h3 id="bs4解析库使用">bs4解析库使用</h3>
<p>'.'对应class属性，‘#’对应id属性</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line">url=<span class="string">&quot;http://www.baidu.com/&quot;</span></span><br><span class="line"></span><br><span class="line">headers=&#123;<span class="string">&quot;user-agent&quot;</span>:</span><br><span class="line"><span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.0.0 Safari/537.36&quot;</span>&#125;</span><br><span class="line">response=requests.get(url,headers=headers)</span><br><span class="line"><span class="comment">#print(response.text)</span></span><br><span class="line">soup=BeautifulSoup(response.text,<span class="string">&#x27;lxml&#x27;</span>) <span class="comment">#lxml是一个解析器</span></span><br><span class="line">btn=soup.select_one(<span class="string">&#x27;#su&#x27;</span>) <span class="comment">#定位采用CSS选择器 定位精确 简便</span></span><br><span class="line"><span class="built_in">print</span>(btn[<span class="string">&#x27;value&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">#因为bs4返回的节点都是python对象，所以获取html标签中的元素只需像python中获取字典形式一样去获取</span></span><br></pre></td></tr></table></figure>
<p>从请求角度，反爬虫可以在http数据包中进行</p>
<ol>
<li>要求用户注册登录才能查看数据，发包形式为GET与POST混合</li>
<li>添加User-Agent，Referer或者Cookie头部校验</li>
<li>增加验证码，将请求包中的参数进行js加密</li>
</ol>
<p>从数据角度，反爬虫可以通过阻碍爬虫开发者查看网页源代码来进行</p>
<ol>
<li>禁止用户右击或者f12</li>
<li>添加控制台反调试，使用无限循环debugger妨碍调试者</li>
<li>改变数据加载方式，使用Ajax动态加载</li>
<li>进行数据加密，返回的数据通过脚本文件解密后再展示</li>
<li>对加密脚本进行混淆，让爬虫者无法阅读源代码</li>
</ol>
<p>爬虫开发者与网站开发者对抗的<strong>五个阶段</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/posts/95017dfa.htm/image-20241113144740357.png" alt="image-20241113144740357"></p>
<h1>常规反爬虫技巧</h1>
<h2 id="Headers头部校验">Headers头部校验</h2>
<p>对头部的三个主要键值对进行判断</p>
<ol>
<li>User-Agent：检测请求者的用户代理，此项缺失则判定为机器人</li>
<li>Referer：检测请求者是否以正常途径跳转到本页面，常用于防盗链技术</li>
<li>Cookie：检测请求者身份状态，需要登录才能访问的网站通常需要携带</li>
</ol>
<p>应对方法：直接复制请求头中相应键值对，需注意：需要登录才能访问的网站，Cookie有时效性，需要及时更新</p>
<p><strong>cookie传递</strong></p>
<p>需要登录才能获取网页数据，或者需要跨请求保持参数时，可以用session对象，自动管理Cookie，当用户登录一个页面，它可以自动识别response中Set-Cookie键值对，为后续请求维持这个Cookie来保持会话信息</p>
<p>下面是POST+GET例子</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="comment">#使用session共享cookie</span></span><br><span class="line">url=<span class="string">&quot;http://www.test.com/login&quot;</span></span><br><span class="line">data=&#123;<span class="string">&quot;username&quot;</span>:<span class="string">&quot;test&quot;</span>,<span class="string">&quot;password&quot;</span>:<span class="string">&quot;12345&quot;</span>&#125;</span><br><span class="line">headers=&#123;<span class="string">&quot;User-Agent&quot;</span>:<span class="string">&quot;xxxxx&quot;</span>&#125;</span><br><span class="line">session=requests.session()</span><br><span class="line">session.headers=headers</span><br><span class="line">post_html=session.post(url,data=data) <span class="comment">#模拟登录</span></span><br><span class="line">get_html=session.get(<span class="string">&quot;http://www.test.com/get&quot;</span>) <span class="comment">#传递Cookie进行信息获取</span></span><br><span class="line"><span class="built_in">print</span>(get_html.text)</span><br></pre></td></tr></table></figure>
<h2 id="IP地址记录">IP地址记录</h2>
<p>防止短时间内大量发起http请求</p>
<p>这种反爬虫手段原理是检测异常访问的用户，如果有请求在短时间内连续访问网站数十次，对ip进行记录，判定为机器人，当该ip再次发起请求，响应403。</p>
<p>应对方法：</p>
<p>减缓http请求间隔，或者建立ip代理池，在进行请求时使用ip代理，被检测后更换ip即可。</p>
<p><strong>案例：豆瓣网站</strong></p>
<p><strong>1.用户延迟访问</strong></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> parse</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DelayRequests</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self,delay=<span class="number">3</span></span>):</span><br><span class="line">        <span class="variable language_">self</span>.delay = delay</span><br><span class="line">        <span class="variable language_">self</span>.urls=&#123;&#125;</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">wait</span>(<span class="params">self,url</span>):</span><br><span class="line">        netloc=parse.urlparse(url).netloc</span><br><span class="line">        <span class="built_in">print</span>(netloc)</span><br><span class="line">        lastone=<span class="variable language_">self</span>.urls.get(netloc,<span class="literal">False</span>)</span><br><span class="line">        <span class="built_in">print</span>(lastone)</span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>.delay&gt;<span class="number">0</span> <span class="keyword">and</span> lastone:</span><br><span class="line">            sleeptime=<span class="variable language_">self</span>.delay-(datetime.now()-lastone).seconds</span><br><span class="line">            <span class="keyword">if</span> sleeptime&gt;<span class="number">0</span>:</span><br><span class="line">                time.sleep(sleeptime)</span><br><span class="line">        <span class="variable language_">self</span>.urls[netloc]=datetime.now()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>记录爬取过的网站域名，如果下一次访问与上一次访问域名相同，且间隔在设置的延迟时间内，就让爬虫沉睡知道延迟时间跑满</p>
<p><strong>2.构建IP代理池</strong></p>
<p>爬取某快代理网站的免费代理，构建IP代理池的代码方案</p>
<p>网站的翻页url数字递增加一</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line"><span class="comment">#所获取代理是否可用</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">verify</span>(<span class="params">proxy</span>): </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = requests.get(<span class="string">&quot;要访问的目标url&quot;</span>, proxies=proxy, timeout=<span class="number">3</span>)</span><br><span class="line">        <span class="keyword">if</span> response.status_code == <span class="number">200</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;获取可用代理&#123;&#125;&quot;</span>.<span class="built_in">format</span>(proxy))</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;&#123;&#125;不可用代理&quot;</span>.<span class="built_in">format</span>(proxy))</span><br><span class="line">        </span><br><span class="line"><span class="comment">#获取代理</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_proxy</span>():</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">10</span>):</span><br><span class="line">        url=<span class="string">&#x27;http://www.kuaidaili.com/free/inha/&#123;&#125;&#x27;</span>,<span class="built_in">format</span>(i)</span><br><span class="line">        response =requests.get(url)</span><br><span class="line">        soup=BeautifulSoup(response)</span><br><span class="line">        datas=soup.select(<span class="string">&#x27;tbody tr&#x27;</span>)</span><br><span class="line">        proxies=&#123;<span class="string">&#x27;http&#x27;</span>:<span class="string">&#x27;http://localhost:8888&#x27;</span>,</span><br><span class="line">                 <span class="string">&#x27;https&#x27;</span>: <span class="string">&#x27;http://localhost:8888&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> data <span class="keyword">in</span> datas:</span><br><span class="line">            ip=data.select(<span class="string">&#x27;td&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">            port=data.select(<span class="string">&#x27;td&#x27;</span>)[<span class="number">1</span>]</span><br><span class="line">            proxy=<span class="string">&quot;http://&quot;</span>+ip.text+<span class="string">&quot;:&quot;</span>+port.text</span><br><span class="line">            proxies[<span class="string">&#x27;http&#x27;</span>]=proxy</span><br><span class="line">            proxies[<span class="string">&#x27;https&#x27;</span>] = proxy</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Get proxy&quot;</span>,<span class="string">&quot;IP:&quot;</span>,ip.text,<span class="string">&quot;Port:&quot;</span>,port.text)</span><br><span class="line">            verify(proxies)</span><br></pre></td></tr></table></figure>
<h2 id="Ajax异步加载">Ajax异步加载</h2>
<p>简单来说就是在访问一个页面时，URL本身没有发生变化，页面内容却发生了动态更新。这时，直接使用get请求去获取网站内容是定位不到具体内容的，因为他的获取一般是经由数据接口进行返回的</p>
<p>面对此类技术只需要网页抓包，在大量数据包中寻找真正包含网页内容的数据接口即可。因为数据如果渲染到页面就一定会有数据包将其传输到客户端，此类技术进行数据传输返回的结果都是JSON格式，用JSON包进行数据解析。JSON格式所以不需要bs4解析DOM语法树</p>
<h2 id="字体反爬虫">字体反爬虫</h2>
<p>对数据进行反爬虫操作。要获取的网页数据在浏览器中正常查看，将其复制到本地就会乱码，他的原理是网站自定义创造一套字体，构建映射关系后将其添加到css的font中，在浏览器中查看网站会自动获取这些文件从而建立对应关系映射得到字符，爬虫时，映射文件空缺，没有字符集解字符，导致乱码</p>
<p>应对两个方法：</p>
<ol>
<li>找到font文件的url地址，将其下载到本地后使用xml解析工具解析，然后根据其中字符对应关系，建立本地映射进行字符替换</li>
<li>手动复制其中加密字符，在本地encode编码，建立自己的本地映射字典，然后进行字符爬取替换</li>
</ol>
<p><strong>案例：实习僧python岗位</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/posts/95017dfa.htm/image-20241113163522007.png" alt="image-20241113163522007"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/posts/95017dfa.htm/image-20241113163535965.png" alt="image-20241113163535965"></p>
<p>发现确实有一些是乱码，</p>
<p>**采用第二种方法:**首先复制单个无法显示字符，encode编码，这里以1-3为例</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line">one=<span class="string">&#x27; &#x27;</span>.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">two=<span class="string">&#x27; &#x27;</span>.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">three=<span class="string">&#x27; &#x27;</span>.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">headers=&#123;<span class="string">&#x27;User-Agent&#x27;</span>:<span class="string">&#x27;xxxxx&#x27;</span>&#125;</span><br><span class="line">response=requests.get(<span class="string">&#x27;目标url&#x27;</span>，headers=headers)</span><br><span class="line">soup=BeautifulSoup(response.text,<span class="string">&#x27;lxml&#x27;</span>)</span><br><span class="line">salary=soup.select(<span class="string">&#x27;span.day.font&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> s <span class="keyword">in</span> salary:</span><br><span class="line">    number=s.text.encode(<span class="string">&#x27;utf-8&#x27;</span>).replace(one,<span class="string">b&#x27;1&#x27;</span>).replace(two,<span class="string">b&#x27;2&#x27;</span>).replace(three,<span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(number.decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br></pre></td></tr></table></figure>
<h2 id="验证码反爬虫">验证码反爬虫</h2>
<p>验证码防护两个阶段：登录注册阶段和访问页面阶段</p>
<p>如果突破了登录注册阶段，发现一ip短时间多次访问，不会直接封ip，而是出现验证码，防止误伤正常用户，</p>
<p>训练大模型的网络爬虫可以突破验证码，所以开发者会在验证码背后加上js参数加密，提高难度。不过使用特殊工具selenium可以直接搭配模型模拟人类行为通过验证码，无须破解js参数加密</p>
<p>对于英数验证码，使用光学字符识别直接识别英数验证码。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> pytesseract</span><br><span class="line">image=Image.<span class="built_in">open</span>(<span class="string">&quot;1234.png&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(pytesseract,image_to_string(image))</span><br></pre></td></tr></table></figure>
<h2 id="JS参数加密">JS参数加密</h2>
<p>常用于post表单提交，主要是为了防范恶意机器人批量注册与模拟登录等行为，如果对POST表单进行抓包会发现在表单里输入的数据被加密成了不可知的字符串，这主要是通过加载网站的本地JS脚本实现的</p>
<p>应对方法：</p>
<ol>
<li>简单的加密可以直接使用python语言进行复现</li>
<li>较复杂一些的加密可以将具体函数提取出来，组成加密脚本后模拟运行</li>
</ol>
<p>淘宝登录案例中：</p>
<p>找到加密js代码，命名为password2.js保存在本地，并编写getPwd接口用于python调用</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/posts/95017dfa.htm/image-20241113202428075.png" alt="image-20241113202428075"></p>
<p>最后通过python调用这个js脚本，获取加密结果</p>
<p>(execjs用于python调用js)</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/posts/95017dfa.htm/image-20241113202553906.png" alt="image-20241113202553906"></p>
<h2 id="JS反调试">JS反调试</h2>
<p>最简单的：检测是否打开开发者工具或者是否修改本地JS脚本文件，从而判断是否进行无限debugger的卡顿，让攻击者无法调试。</p>
<p>这种反爬虫的破解可以通过JS Hook</p>
<p>对于无限循环debugger应对：</p>
<ol>
<li>在debugger设置条件断点写入false</li>
<li>本地覆盖：在使用本地覆盖时，发现这个JS文件名字是VMXXX，显然不是正常的js脚本文件。因为当Ajax加载html内容时，如果包含script标签，Chrome就会自动对脚本进行eval()运算，并被Chrome的source面板识别为VM开头的新文件，转到网络面板，找到Ajax请求，原始的js会存放在响应里，然后本地去除其中的debugger或者反调试函数，将修改过的文件返回回去。</li>
</ol>
<h2 id="AST混淆反爬虫">AST混淆反爬虫</h2>
<p>把代码进行ast混淆，转化为不可阅读，不可识别却能正常运作的乱码文件。</p>
<h1>混淆js手动逆向方法</h1>
<p><strong>基本步骤</strong></p>
<ul>
<li>定位加密入口</li>
<li>混淆特征分析</li>
<li>加密函数还原</li>
</ul>
<h2 id="数组混淆和数组乱序">数组混淆和数组乱序</h2>
<p>数组混淆是将全脚本的所有字符串进行提取加密，在js脚本头部组成加密字符串数组，之后的字符串调用将以获取数组的形式获取字符串，但是字符串位置固定，所以数组混淆和数组乱序通常搭配使用。</p>
<p>数组混淆的特征是，混淆脚本头部会存一个较长的字符串加密数组；数组乱序的特征是代码中包含push和shift字符串，用于打乱数组顺序</p>
<h2 id="字符串加密">字符串加密</h2>
<p>比较常用的事base64加密，特征是脚本中会存在atob方法，用于base64加密文本的解密。</p>
<h2 id="字符串花指令">字符串花指令</h2>
<p>是一些无用的代码，主要为了增加破解难度，最常见的字符串花指令就是四则运算的改写</p>
<h2 id="switch流程控制平坦化">switch流程控制平坦化</h2>
<p>会把原先的代码执行链拆分为switch判断的多循环结构，作为switch执行的分发器，然后将原本的代码改写为switch形式，按照分发器的顺序进行case判断。最显著特征为存在一个循环的while结构，其中包含多个以数组为判断条件的case结构，在他上面的变量声明一般为分发器</p>
<h1>JS代码安全防护原理</h1>
<h2 id="常量的混淆">常量的混淆</h2>
<h3 id="对象属性的两种访问方式">对象属性的两种访问方式</h3>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">People</span>(<span class="params">name</span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span>=name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">People</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">sayHello</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Hello&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> <span class="title class_">People</span>(<span class="string">&quot;zxk1ng&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(p.<span class="property">name</span>);</span><br><span class="line">p.<span class="title function_">sayHello</span>();</span><br><span class="line"><span class="comment">//简单混淆</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(p[<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">p[<span class="string">&#x27;sayHello&#x27;</span>]();</span><br><span class="line"></span><br><span class="line"><span class="comment">//在JavaScript中，prototype 是一个特殊的属性，它与构造函数（constructor）和对象实例（instances）之间的关系有关。这个属性主要用于实现继承和共享方法。每个 JavaScript 函数都有一个 prototype 属性，它是一个指向对象的引用。当你创建一个新的对象实例时，这个实例会继承其构造函数的 prototype 对象上的属性和方法。</span></span><br></pre></td></tr></table></figure>
<p>JS中，很多内置对象都是window的属性，代码中定义的全局变量都是全局对象window的属性，定义的全局函数都是全局对象window的方法，全局对象的属性或者方法在调用时可以省略全局对象名。[]形式调用则不能省略，如</p>
<p><code>new window.Date() == new Date() == new window['Date']()</code></p>
<h3 id="十六进制字符串">十六进制字符串</h3>
<p>字符串的十六进制形式代替字符串</p>
<p>字符变为字节形式，如’yy’-&gt;'\x79\x79’再转化为Hex形式</p>
<p>脚本实现上面的混淆</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">hexEnc</span>(<span class="params">code</span>)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> hexStr=[],i=<span class="number">0</span>,s;i&lt;code.<span class="property">length</span>;i++)&#123;</span><br><span class="line">        s=code.<span class="title function_">charCodeAt</span>(i).<span class="title function_">toString</span>(<span class="number">16</span>);</span><br><span class="line">        hexStr+=<span class="string">&quot;\\x&quot;</span>+s;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> hexStr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//charAt是取出字符串中对应索引的字符，而charCodeAt用来取出对应索引字符的ASCII码，然后toString(16)转化为十六进制</span></span><br></pre></td></tr></table></figure>
<p><code>var a =&#123;&quot;name&quot; : &quot;zxk1ng&quot;&#125;;</code></p>
<p>这里的”name“不能拼接不能加密，但是可以变为字节形式</p>
<h3 id="unicode">unicode</h3>
<p><strong>可以对变量和字符串进行unicode</strong></p>
<p>例子</p>
<p><code>var Week=['一','二']  &lt;==&gt;var Week=['\u4e00','\u4e8c']</code></p>
<p><code>'Date' &lt;==&gt;</code> ‘\u0044\u0061\u0074\u0065’</p>
<p>以下代码实现unicode转换</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">unicodeEnc</span>(<span class="params">str</span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> value=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;str.<span class="property">length</span>;i++)&#123;</span><br><span class="line">        value+=<span class="string">&quot;\\u&quot;</span>+(<span class="string">&quot;0000&quot;</span>+<span class="built_in">parseInt</span>(str.<span class="title function_">charCodeAt</span>(i)).<span class="title function_">toString</span>(<span class="number">16</span>)).<span class="title function_">substr</span>(-<span class="number">4</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>unicode字符串的还原方法，与十六进制字符串一样，把字符串放到控制台中输出即可</p>
<h3 id="字符串的ASCII码混淆">字符串的ASCII码混淆</h3>
<p>为了完成这个混淆需要String对象下的charCodeAt和fromCharCode(和charCodeAt过程相反)</p>
<p><code>console.log('b'.charCodeAt(0));</code></p>
<p><code>console.log(String.fromCharCode(120,12));</code>可以有多个参数，<strong>返回字符串</strong></p>
<p>把一个字符串转化为字节数组</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">stringToByte</span>(<span class="params">str</span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> byteArr=[];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;str.<span class="property">length</span>;i++)&#123;</span><br><span class="line">        byteArr.<span class="title function_">push</span>(str.<span class="title function_">charCodeAt</span>(i));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> byteArr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>fromCharCode接收的参数类型不是数组，如果想要传递数组，可以使用String.fromCharCode.apply(null,[102,111,114])，apply是函数对象就有的方法。</p>
<p>eval与function可以把字符串当做代码使用，function用来生成一个函数。</p>
<p>atob() 方法用于解码 base-64 编码的字符串。</p>
<p>btoa()用于编码base64</p>
<ul>
<li>如果用base64编码后的方法要正常使用，需要atob(“xxx”)才能正常发挥这个方法功能。</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/posts/95017dfa.htm/image-20241113230217551.png" alt="image-20241113230217551"></p>
<h3 id="数值常量加密">数值常量加密</h3>
<p>例如md5加密中的常量值，把他变化就不易确定这是哪个加密算法或不容易找到关键代码。</p>
<h2 id="增加逆向的工作量">增加逆向的工作量</h2>
<h3 id="数组混淆">数组混淆</h3>
<p>所有字符串提取到一个数组中，在引用字符串的地方全都以数组下标的方式去访问数组成员(数组里的一般会进行加密变化)，如</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> bigArr = [<span class="string">&#x27;Date&#x27;</span>,<span class="string">&#x27;getTime&#x27;</span>,<span class="string">&#x27;log&#x27;</span>];</span><br><span class="line"><span class="variable language_">console</span>[bigArr[<span class="number">2</span>]](<span class="keyword">new</span> <span class="variable language_">window</span>[bigArr[<span class="number">0</span>]]()[bigArr[<span class="number">1</span>]]());</span><br><span class="line"><span class="comment">//console.log(new window.Date().getTime());</span></span><br></pre></td></tr></table></figure>
<p><strong>在别的语言，同一个数组只能存放同一类型，但是JS可以存放多个类型</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">People</span>(<span class="params"></span>)&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">People</span>.<span class="property">a</span>=<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> <span class="title class_">People</span>();</span><br><span class="line">p.<span class="property">constructor</span>.<span class="title function_">a</span>(); ==&gt;会输出hello</span><br><span class="line">p.<span class="property">constructor</span>       ==&gt;输出构造函数 <span class="keyword">function</span> <span class="title function_">People</span>(<span class="params"></span>)&#123;&#125;</span><br></pre></td></tr></table></figure>
<p><code>console.log(&quot;&quot;['constructor']['fromCharCode'](120));   输出x </code>相当于调用String下的fromCharCode方法。最前面可以是任意的字符串对象，也可以是空字符串，constructor代表获取构造函数，因此<code>&quot;&quot;['constructor']</code>等同于String</p>
<h3 id="数组乱序">数组乱序</h3>
<p>把数组成员打乱顺序，然后在索引成员之前再把数组恢复原来的顺序</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//数组打乱</span></span><br><span class="line"><span class="keyword">var</span> bigArr=[<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>];</span><br><span class="line">(<span class="keyword">function</span>(<span class="params">arr,num</span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> shuffer=<span class="keyword">function</span>(<span class="params">nums</span>)&#123;</span><br><span class="line">        <span class="keyword">while</span>(--nums)&#123;</span><br><span class="line">            arr.<span class="title function_">unshift</span>(arr.<span class="title function_">pop</span>()); <span class="comment">//最后成员放在开头</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="title function_">shuffer</span>(++num);</span><br><span class="line">&#125;(bigArr,<span class="number">0x20</span>));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(bigArr);</span><br></pre></td></tr></table></figure>
<p>数组恢复</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//数组打乱</span></span><br><span class="line"><span class="keyword">var</span> bigArr=[填入打乱后的数组顺序];</span><br><span class="line">(<span class="keyword">function</span>(<span class="params">arr,num</span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> shuffer=<span class="keyword">function</span>(<span class="params">nums</span>)&#123;</span><br><span class="line">        <span class="keyword">while</span>(--nums)&#123;</span><br><span class="line">            arr[<span class="string">&#x27;push&#x27;</span>](arr[<span class="string">&#x27;shift&#x27;</span>]());<span class="comment">//第一个成员放在最后</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="title function_">shuffer</span>(++num);</span><br><span class="line">&#125;(bigArr,<span class="number">0x20</span>));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(bigArr);</span><br></pre></td></tr></table></figure>
<h3 id="花指令">花指令</h3>
<p>添加一些没有意义却可以混淆视听的代码，是花指令的核心</p>
<h3 id="jsfuck">jsfuck</h3>
<p>jsfuck也是一种编码，把js代码转化为只用6个字符就可以表示的代码。比如常量8转化为jsfuck为：</p>
<p><code>(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])</code></p>
<p>基本原理：</p>
<p>+号是js一个运算符，当他作为一元运算符使用，代表强转为数值型。[]是空数组所以+[]等于0，!+[]等同于!0，js是一种弱类型语言，js引擎会在适当时候，自动完成类型隐式转化。!是js的取反，也就是这时候需要一个布尔值。（js中7种值为假值：false,undefuned,null,0,-0,NaN,“”，其他都是真），因此!0是true，!![]两次取反还是真。</p>
<p>+号作为二元运算符的时候，加入一边有字符串表示拼接。如果两边都没有表示数值相加。</p>
<p>实际开发中，jsfuck应用有限，只会应用于js中的一部分代码，主要由于还原简单，直接在控制台输入即可输出结果。</p>
<h2 id="代码执行流程防护原理">代码执行流程防护原理</h2>
<h3 id="流程平坦化">流程平坦化</h3>
<p>通过switch…case语句改变原来的流程</p>
<h3 id="逗号表达式混淆">逗号表达式混淆</h3>
<p>把多个表达式或语句连接成一个复合语句。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">test</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> a=<span class="number">1000</span>;</span><br><span class="line">    <span class="keyword">var</span> b=a+<span class="number">2000</span>;   </span><br><span class="line">    <span class="keyword">var</span> c=b+<span class="number">3000</span>;</span><br><span class="line">    <span class="keyword">return</span> c;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>逗号表达式</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">test</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> a,b,c;</span><br><span class="line">    <span class="keyword">return</span> a=<span class="number">1000</span>,</span><br><span class="line">    b=a+<span class="number">2000</span>,</span><br><span class="line">    c=b+<span class="number">3000</span>,</span><br><span class="line">    c</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//return语句后通常只能跟一个表达式，他会返回这个表达式的结果，但是逗号运算符可以把多个表达式连接成一个复合语句。所以上述代码会返回最后一个表达式计算后的结果，但是前面的表达式依然会执行，</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a=(a=<span class="number">1000</span>,a+=<span class="number">2000</span>) ==&gt;<span class="number">3000</span><span class="string">``</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a)</span><br><span class="line"></span><br><span class="line"><span class="comment">//第一行括号代表是一个整体，也就是把整体赋值给a，会先执行a=1000,再</span></span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">test</span>(<span class="params">a,b,c</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> c=(b=(a=<span class="number">1000</span>,a+<span class="number">2000</span>),b+<span class="number">3000</span>); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>逗号表达式混淆不仅能处理赋值表达式，还能处理调用表达式，成员表达式，如下案例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj=&#123;</span><br><span class="line">    <span class="attr">name</span>:<span class="string">&quot;xxx&quot;</span>,</span><br><span class="line">    <span class="attr">add</span>:<span class="keyword">function</span>(<span class="params">a,b</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> a+b;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sub</span>(<span class="params">a,b</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> a-b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">test</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> a=<span class="number">1000</span>;</span><br><span class="line">    <span class="keyword">var</span> b=<span class="title function_">sub</span>(a,<span class="number">3000</span>)+<span class="number">1</span></span><br><span class="line">    <span class="keyword">var</span> c=b+obj.<span class="title function_">add</span>(b,<span class="number">2000</span>);</span><br><span class="line">    <span class="keyword">return</span> c+obj.<span class="property">name</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>test函数中有函数调用表达式，还有成员表达式，可以使用下面两个方法进行处理：</p>
<ul>
<li>提升变量声明到参数中</li>
<li><code>b=(a=1000,sub)(a,3000)+1</code>中的<code>(a=1000,sub)</code>可以整体返回sub函数，然后直接调用，最后加1赋值给b<br>
同理，如果sub改为obj.add的话，可以处理成<code>(a=1000,obj.add)(a,3000)</code>，或者<code>(a=1000,obj).add(a,3000)</code></li>
</ul>
<p>第二种方法是调用表达式在等号右边的情况，例如test中第三句，里面的b+obj.add(b,2000)，可以对obj.add进行包装，处理成<code>b+(0,obj.add)(b,2000)</code>或者<code>b+(0,obj).add(b,2000)</code>,括号中0可以换成花指令</p>
<h2 id="其他代码防护方案">其他代码防护方案</h2>
<h3 id="eval加密">eval加密</h3>
<p>eval加密网址：<a target="_blank" rel="noopener" href="http://www.jqueryfuns.com/tools/jsencode">http://www.jqueryfuns.com/tools/jsencode</a></p>
<p>eval全局函数，把一段字符串当做代码执行。</p>
<h3 id="内存爆破">内存爆破</h3>
<p>是在代码中加入死代码，正常情况下，这段代码不执行，当检测函数被格式化或者函数被Hook就跳转到这段代码执行，这道内存溢出程序崩溃</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> d=[<span class="number">0x1</span>,<span class="number">0x0</span>,<span class="number">0x0</span>];</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">b</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0x0</span>,c=d.<span class="property">length</span>;i&lt;c;i++)&#123;</span><br><span class="line">        d.<span class="title function_">push</span>(<span class="title class_">Math</span>.<span class="title function_">round</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>()));</span><br><span class="line">        c=d.<span class="property">length</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="检测代码是否格式化">检测代码是否格式化</h3>
<p>在js中，函数是可以转为字符串的。因此可以选择一个函数转化为字符串然后跟内置字符串对比或用正则匹配。没有匹配上就说明被格式化了</p>
<p>函数转字符串如下</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">add</span>(<span class="params">a,b</span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> a+b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(add+<span class="string">&quot;&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(add.<span class="title function_">toString</span>());</span><br><span class="line"><span class="comment">//&quot;function add(a,b)&#123;return a+b;&#125;&quot;</span></span><br></pre></td></tr></table></figure>
<p>在Chrome中，把代码格式化后会产生一个后缀为<code>formatted</code>的文件，之后这个文件中设置断点，触发断点，会停在这个文件，但是这时把某个函数转化为字符串，取到的依然是格式化之前的代码，这种检测方法检测不到这种情况，那么这种检测方法应用场景如何？</p>
<p>在分析完算法想要获得结果，会选择直接修改源文件，然后运行结果，把格式化后代码保存成一个本地文件，这时某个函数转化为字符串取到的就是格式化后的结果</p>
<p>如果检测格式化，可以跳到内存爆破中</p>
<h1>AST的API详解</h1>
<h2 id="AST入门">AST入门</h2>
<h3 id="AST基本结构">AST基本结构</h3>
<p>经过Babel解析，里面的元素叫做节点(Node)，同时Babel提供许多方法去操作节点</p>
<p><strong>源代码</strong>`</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj=&#123;</span><br><span class="line">    <span class="attr">name</span>:<span class="string">&quot;xxx&quot;</span>,</span><br><span class="line">    <span class="attr">add</span>:<span class="keyword">function</span>(<span class="params">a,b</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> a+b+<span class="number">1000</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">mul</span>:<span class="keyword">function</span>(<span class="params">a,b</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> a*b+<span class="number">1000</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>可以在AST Explorer网站中对其进行Babel解析为AST，解析后AST有很多层级，这些层级互为父子节点对于解析后的结构查看相应的书籍内容即可，这里只是记录一些基础名称</p>
<ul>
<li>VariableDeclaration：表示是变量声明语句</li>
<li>kind：表示变量声明语句使用的关键字</li>
<li>declarations：声明的具体变量，是一个数组。</li>
<li>每一个变量都以VariableDeclarator表示</li>
<li>VariableDeclarator的属性主要是id和init，对于init，如果只是声明没有初始值，init为null，否则init节点下还有内容</li>
<li>对于上述原始代码而言，把对象字面量赋值给obj，成为ObjectExpression(对象表达式)，有对象自然有属性，所以properties是数组，一个属性对应一个成员，查看properties下内容</li>
<li>ObjectProperty：表示对象属性，</li>
<li>因为对象是键值对组成，在表示对象属性时，会有key和value两个节点，key是Identifier(标识符)，名字是name，对象的key也可以用字符串表示，这是key节点类型变为StringLiteral(字符串字面量)，value类型为StringLiteral</li>
<li>extra节点可以删除</li>
<li>对于函数表达式赋值给对象属性：type为FunctionExpression，函数名对象id节点，由于代码把一个匿名函数赋值给obj的add属性，所以这里id为null，函数参数对应params节点，是个数组，**如果没参数params节点为空数组，**函数体对应body节点</li>
<li>一般函数体都会用BlockStatement节点包裹，，BlockStatement里的body节点是多条语句，所以body是数组，如果函数有&quot;use strict&quot;标记，那么directives里会有相应节点</li>
<li>ReturnStatement(返回语句)</li>
<li>argument：函数返回内容，没有返回则为null</li>
<li>BinaryExpression：二元式</li>
<li>NumericLiteral：数值字面量</li>
</ul>
<h3 id="代码基本结构">代码基本结构</h3>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">&#x27;fs&#x27;</span>);   <span class="comment">//读写文件</span></span><br><span class="line"><span class="keyword">const</span> parser = <span class="built_in">require</span>(<span class="string">&quot;@babel/parser&quot;</span>);  <span class="comment">//@babel/parser：用来将js代码转化为AST</span></span><br><span class="line"><span class="keyword">const</span> traverse = <span class="built_in">require</span>(<span class="string">&quot;@babel/traverse&quot;</span>).<span class="property">default</span>;<span class="comment">//@babel/traverse:遍历ast中的节点</span></span><br><span class="line"><span class="keyword">const</span> t = <span class="built_in">require</span>(<span class="string">&quot;@babel/types&quot;</span>);            <span class="comment">//@babel/types：判断节点类型，生成新的节点等</span></span><br><span class="line"><span class="keyword">const</span> generator = <span class="built_in">require</span>(<span class="string">&quot;@babel/generator&quot;</span>).<span class="property">default</span>;  <span class="comment">//ast转化为js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> jscode = fs.<span class="title function_">readFileSync</span>(<span class="string">&quot;./demo.js&quot;</span>, &#123;</span><br><span class="line">	<span class="attr">encoding</span>: <span class="string">&quot;utf-8&quot;</span></span><br><span class="line">  &#125;);</span><br><span class="line"><span class="keyword">let</span> ast = parser.<span class="title function_">parse</span>(jscode);</span><br><span class="line"></span><br><span class="line"><span class="comment">//在这里对AST进行一系列的操作</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> code = <span class="title function_">generator</span>(ast).<span class="property">code</span>;</span><br><span class="line">fs.<span class="title function_">writeFile</span>(<span class="string">&#x27;./demoNew.js&#x27;</span>, code, <span class="function">(<span class="params">err</span>)=&gt;</span>&#123;&#125;);</span><br></pre></td></tr></table></figure>
<p><strong>AST处理JS基本步骤</strong></p>
<ul>
<li>读取js文件解析为AST</li>
<li>对节点增删改查</li>
<li>生成js代码</li>
</ul>
<p><strong>后续内容没有特殊说明都以这个结构为准，代码只展现中间对ast有操作的部分</strong></p>
<h2 id="Babel中的组件">Babel中的组件</h2>
<p>Babel的编译过程主要以下三个阶段</p>
<ul>
<li>解析：将输入字符流解析AST抽象语法树</li>
<li>转化：对抽象语法树进一步转化</li>
<li>生成：根据转化后的语法树生成目标代码</li>
</ul>
<h3 id="Babel的解析">Babel的解析</h3>
<p>包括两个内容：词法分析与语法分析，经过这一步以后，可以直接得到输入源代码的AST抽象语法树</p>
<h3 id="Babel的转化">Babel的转化</h3>
<p>转化步骤接收ast并对其进行遍历，再次过程中对节点进行添加，更新及移除等操作。后续对混淆js代码以及混淆js代码的还原都在此处，<strong>这是本书的重点</strong>，之所以将字符流转化为抽象语法树，原因是树状结构更加容易进行原子操作，可以对任意节点进行精细化的处理。在抽象语法树中，代码见得关系被抽象为节点的关系，而实现相同功能的节点之间的表示也是相同的，利用这一点，可以再语法树层面对输入的代码进行增删改查，而不必关心代码的书写。制定几条规则，Babel就可以对抽象语法树进行遍历，完成整个代码批量操作</p>
<h3 id="Babel的生成">Babel的生成</h3>
<p>代码生成步骤把最终的ast语法树转换成字符串式的代码，代码生成很简单：深度优先遍历整个AST，然后构建可以表示转化后代码的字符串，经过这一步，就可以得到从ast抽象语法层层面修改过的代码。</p>
<h3 id="parser与generator">parser与generator</h3>
<p>parser：将JS代码转化为AST  ==&gt; <code>let ast=parser.parse(jscode)</code>输出前使用JSON.stringify把对象转为json数据，如<code>JSON.stringify(ast,null,2)</code></p>
<p>generator：将AST转化为JS ==》 <code>let code=generator(ast).code</code>返回 一个对象，其中code属性才是需要的代码。</p>
<p>parser的parse是有两个参数，但是第二个参数在es6中才需要写出来，例如当看到js代码中有import，export时，就需要写出第二个参数且sourceType要指定为module。(sourceType默认为script)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> ast = parser.<span class="title function_">parse</span>(jscode,&#123;</span><br><span class="line">    <span class="attr">sourceType</span>:<span class="string">&quot;module&quot;</span>,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>generator返回的一个对象，同时他的第二个参数接纳一个对象，可以设置一些来影响输出结果。如：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> code = <span class="title function_">generator</span>(ast, &#123;</span><br><span class="line">	<span class="attr">retainLines</span>: <span class="literal">false</span>, </span><br><span class="line">	<span class="attr">comments</span>: <span class="literal">false</span>, </span><br><span class="line">	<span class="attr">compact</span>: <span class="literal">true</span></span><br><span class="line">&#125;).<span class="property">code</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(code);</span><br></pre></td></tr></table></figure>
<p>retainLines表示是否使用与源代码相同的行号，默认false，输出的是格式化之后的代码。</p>
<p>comments表示是否保留注释，默认true。</p>
<p>compact表示是否压缩代码，其中minified压缩程度最多，concise最少</p>
<h3 id="traverse与visitor">traverse与visitor</h3>
<p>traverse用来遍历AST，但是单纯遍历没有意义，所以配合visitor使用。</p>
<p><code>visitor</code>是一个对象，她可以用来定义一些方法，用来过滤节点。</p>
<p><strong>案例理解traverse与visitor</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> visitor=&#123;&#125;;</span><br><span class="line">visitor.<span class="property">FunctionExpression</span>=<span class="title function_">funtion</span>(<span class="params">path</span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;xxx&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">traverse</span>(ast,visitor);</span><br></pre></td></tr></table></figure>
<p><strong>分析</strong>：声明对象，名字随便。再给对象增加一个名为FunctionExpression的方法，它的名字是需要遍历的节点的类型(注意大小写)。traverse会遍历ast所有节点，当节点是FunctionExpression类型，调用visitor中的方法。visitor中的方法接收一个参数，traverse在遍历时，会把当前节点的Path对象传给他。最后把visitor作为第二个参数传到traverse里，第一个参数是ast。</p>
<p><strong>定义visitor的三种方式</strong></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> visitor1=&#123;</span><br><span class="line">    <span class="title class_">FunctionExpression</span>:<span class="keyword">function</span>(<span class="params">path</span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;xxx&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//最常用</span></span><br><span class="line"><span class="keyword">const</span> visitor2=&#123;</span><br><span class="line">    <span class="title class_">FunctionExpression</span>(path)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;xxx&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> visitor3=&#123;</span><br><span class="line">    <span class="title class_">FunctionExpression</span>:&#123;</span><br><span class="line">        <span class="title function_">enter</span>(<span class="params">path</span>)&#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;xxx&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//在visitor3中存在一个enter，表示进入节点时，还有一个exit 表示退出节点时，这两个时机可以访问节点</span></span><br></pre></td></tr></table></figure>
<p>还可以把方法名使用<code>'|'</code>连接，如<code>FunctionExpression|BinaryExpression</code>形式字符串,把一个方法应用对个节点中。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> visitor2=&#123;</span><br><span class="line">    <span class="string">&quot;FunctionExpression | BinaryExpression &quot;</span>(path)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;xxx&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>也可以把多个函数应用一个节点中，如原先是把一个函数赋值给enter或者exit，现在改为函数的数组，会按照顺序依次进行。如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">func1</span>(<span class="params">path</span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;func1&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">func2</span>(<span class="params">path</span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;func2&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> visitor3=&#123;</span><br><span class="line">    <span class="title class_">FunctionExpression</span>:&#123;</span><br><span class="line">        <span class="attr">enter</span>:[func1,func2]          </span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>traverse并非必须从遍历，它可从任意节点向下遍历，例如想要把代码中所有函数的第一个参数改为x</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> updateParamNameVisitor=&#123;</span><br><span class="line">    <span class="title class_">Identifier</span>(path)&#123;</span><br><span class="line">        <span class="keyword">if</span>(path.<span class="property">node</span>.<span class="property">name</span> === <span class="variable language_">this</span>.<span class="property">paramName</span>)&#123;</span><br><span class="line">            path.<span class="property">node</span>.<span class="property">name</span>=<span class="string">&#x27;x&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">const</span> visitor=&#123;</span><br><span class="line">    <span class="title class_">FunctionExpression</span>(path)&#123;</span><br><span class="line">        <span class="keyword">const</span> paramName=path.<span class="property">node</span>.<span class="property">params</span>[<span class="number">0</span>].<span class="property">name</span>;<span class="comment">//取出函数第一个参数名</span></span><br><span class="line">        path.<span class="title function_">traverse</span>(updateParamNameVisitor,&#123;</span><br><span class="line">            paramName</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="title function_">traverse</span>(ast,visitor)；</span><br></pre></td></tr></table></figure>
<p>解析：先用traverse根据visitor去遍历所有节点，当遍历到 FunctionExpression节点，用path.traverse根据updateParamNameVisitor去遍历当前节点下所有子节点，然后修改与函数第一个参数相同的标识符，在使用 path.traverse还可以传入一个对象，在对应的visitor中用this引用它</p>
<h3 id="type组件">type组件</h3>
<p>该组件主要用来判断节点的类型，生成新的节点等。</p>
<p>t.isIdentifier(path.node)，等同于path.node.type === “Identifier”,还可以再判断类型的同时附加条件，如</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">traverse</span>(ast,&#123;</span><br><span class="line">    <span class="title function_">enter</span>(<span class="params">path</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span>(path.<span class="property">node</span>.<span class="property">type</span> === <span class="string">&quot;Identifier&quot;</span> &amp;&amp; path.<span class="property">node</span>.<span class="property">name</span>===<span class="string">&quot;n&quot;</span>)&#123;</span><br><span class="line">			path.<span class="property">node</span>.<span class="property">name</span>=<span class="string">&quot;x&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//等同于</span></span><br><span class="line"><span class="title function_">traverse</span>(ast,&#123;</span><br><span class="line">    <span class="title function_">enter</span>(<span class="params">path</span>)&#123;</span><br><span class="line">		<span class="keyword">if</span>(t.<span class="title function_">isIdentifier</span>(path.<span class="property">node</span>，&#123;<span class="attr">name</span>:<span class="string">&#x27;n&#x27;</span>&#125;))&#123;</span><br><span class="line">			path.<span class="property">node</span>.<span class="property">name</span>=<span class="string">&quot;x&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>如果要判断其他类型，只需要改is后面的类型。</p>
<p>当节点不符合要求，抛出错误</p>
<p>```t.assertBinaryExpression(node对象)` 是一种断言工具，用于检查传入的节点是否是 二元表达式（BinaryExpression）。``</p>
<p><code>t.assertBinaryExpression(maybeBinaryExpressionNode,&#123;operator:&quot;*&quot;&#125;); 判断是否是二项式并且操作符是*</code></p>
<h2 id="Path对象详解">Path对象详解</h2>
<h3 id="Path与Node区别">Path与Node区别</h3>
<p><code>path.stop</code>：停止遍历节点 与Babel中的<code>path.skip</code>类似</p>
<p>path.node能取出某类型的node对象，节点是Path的一部分，Path是一个对象，用来描述两个节点之间的连接</p>
<h3 id="Path中的方法">Path中的方法</h3>
<h4 id="获取子节点-path">获取子节点/path</h4>
<p>为了得到ast节点的属性值，一般先访问到该节点，然后利用path.node.property获取属性(property代指某个属性名)，如path.node.right，path.node.left，path.node.operator，通过这个方法获得的是Node或者具体属性值。</p>
<p>Node不能使用Path的方法，如果要获得该属性的Path，使用path.get(“属性名 字符串形式”)</p>
<p>任何形式属性值，通过path.get去获取，都会包装为Path对象再返回，像name,operator这一类就没必要包装</p>
<h4 id="判断Path类型">判断Path类型</h4>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/posts/95017dfa.htm/image-20241115203344621.png" alt="image-20241115203344621"></p>
<h4 id="节点转代码">节点转代码</h4>
<p>generator组件可以把ast代码中的一部分节点转为代码，这对节点遍历过程中的调试有帮助</p>
<h4 id="替换节点属性">替换节点属性</h4>
<p>替换节点属性与获取节点属性方法相同，只是改为赋值，但也不是随意替换，需注意，替换的类型要在允许的类型范围内</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> visitor3=&#123;</span><br><span class="line">    <span class="title class_">BinaryExpression</span>:&#123;</span><br><span class="line">        <span class="title function_">enter</span>(<span class="params">path</span>)&#123;</span><br><span class="line">            path.<span class="property">node</span>,left=t.<span class="title function_">identifier</span>(<span class="string">&quot;x&quot;</span>)</span><br><span class="line">            path.<span class="property">node</span>,right=t.<span class="title function_">identifier</span>(<span class="string">&quot;y&quot;</span>)</span><br><span class="line">		&#125;     </span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="替换整个节点">替换整个节点</h4>
<p>Path中与替换相关的方法：replaceWith,replaceWithMultiple,replaceInline,replaceWithSourceString</p>
<p>replaceWith,是用一个节点替换另一个节点，严格一换一</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> visitor=&#123;</span><br><span class="line">    <span class="title class_">BinaryExpression</span>(path)&#123;</span><br><span class="line">        path.<span class="title function_">replaceWith</span>(t.<span class="title function_">valueToNode</span>(<span class="string">&quot;xxxx&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">traverse</span>(ast,visitor);</span><br></pre></td></tr></table></figure>
<p>replaceWithMultiple也是节点换节点，不过是多换一</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> visitor=&#123;</span><br><span class="line">    <span class="title class_">ReturnStatement</span>(path)&#123;</span><br><span class="line">        path.<span class="title function_">replaceWithMultiple</span>([</span><br><span class="line">            t.<span class="title function_">expressionStatement</span>(t.<span class="title function_">stringLiteral</span>(<span class="string">&quot;xxx&quot;</span>)),</span><br><span class="line">            t.<span class="title function_">expressionStatement</span>(t.<span class="title function_">numericLiteral</span>(<span class="number">1000</span>)),</span><br><span class="line">            t.<span class="title function_">returnStatement</span>(),</span><br><span class="line">        ]);</span><br><span class="line">       	path.<span class="title function_">stop</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">traverse</span>(ast,visitor);</span><br></pre></td></tr></table></figure>
<p>代码解析：当表达式语句单独在一行(没有赋值)，最好用expressionStatement包裹，替换后的节点，traverse也能遍历到。</p>
<p>replaceInline接收一个参数，如果参数不是数组，那么replaceInline等同于replaceWith；如果是数组，则等同于replaceWithMultiple，其中的数组成员必须是节点</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> visitor=&#123;</span><br><span class="line">    <span class="title class_">StringLiteral</span>(path)&#123;</span><br><span class="line">        path.<span class="title function_">replaceInline</span>(</span><br><span class="line">        	t.<span class="title function_">stringLiteral</span>(<span class="string">&quot;1111&quot;</span>));</span><br><span class="line">        path.<span class="title function_">stop</span>();</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title class_">ReturnStatement</span>(path)&#123;</span><br><span class="line">        path.<span class="title function_">replaceInline</span>([</span><br><span class="line">            t.<span class="title function_">expressionStatement</span>(t.<span class="title function_">stringLiteral</span>(<span class="string">&quot;xxx&quot;</span>)),</span><br><span class="line">            t.<span class="title function_">expressionStatement</span>(t.<span class="title function_">numericLiteral</span>(<span class="number">1000</span>)),</span><br><span class="line">            t.<span class="title function_">returnStatement</span>(),</span><br><span class="line">        ]);</span><br><span class="line">       	path.<span class="title function_">stop</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">traverse</span>(ast,visitor);</span><br></pre></td></tr></table></figure>
<p>replaceWithSourceString()：用字符串源码替换节点，如把原始代码中的函数改为闭包形式</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">traverse</span>(ast,&#123;</span><br><span class="line">    <span class="title class_">RertuenStatement</span>(path)&#123;</span><br><span class="line">        <span class="keyword">let</span> argumentPath=path.<span class="title function_">get</span>(<span class="string">&#x27;argument&#x27;</span>);</span><br><span class="line">        argumentPath.<span class="title function_">replaceWithSourceString</span>(</span><br><span class="line">            <span class="string">&#x27;function()&#123;return&#x27;</span>+argumentPath+<span class="string">&#x27;&#125;()&#x27;</span></span><br><span class="line">        );</span><br><span class="line">        path.<span class="title function_">stop</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="删除节点">删除节点</h4>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">traverse</span>(ast,&#123;</span><br><span class="line">    <span class="title class_">EmptyStatement</span>(path)&#123;</span><br><span class="line">        path.<span class="title function_">remove</span>(); <span class="comment">//删除当前节点</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>EmptyStatement指的是空语句，就是多余的分号。</p>
<h4 id="插入节点">插入节点</h4>
<p>想要把节点插入到兄弟节点中，可以使用insertBefore和insertAfter分别在当前节点前后插入结点</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">traverse</span>(ast,&#123;</span><br><span class="line">   <span class="title class_">ReturnStatement</span>(path)&#123;</span><br><span class="line">        path.<span class="title function_">insertBefore</span>(t.<span class="title function_">expressionStatement</span>(t.<span class="title function_">stringLiteral</span>(<span class="string">&quot;before&quot;</span>))); </span><br><span class="line">       path.<span class="title function_">insertAfter</span>(t.<span class="title function_">expressionStatement</span>(t.<span class="title function_">stringLiteral</span>(<span class="string">&quot;after&quot;</span>)));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="父级Path">父级Path</h3>
<p>Path对象中有parentPath和parent两个属性，其中parentPath类型为NodePath，他是父级Path，parent类型为Node，他是父节点。</p>
<p>父级Path获取：path.parentPath，path.parentPath.node等同于path.parent。</p>
<h4 id="path-findParent">path.findParent</h4>
<p>个别情况下，需要从一个路径向上遍历语法树，直到满足相应的条件，这时可以使用findParent。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">traverse</span>(ast,&#123;</span><br><span class="line">   <span class="title class_">ReturnStatement</span>(path)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(path.<span class="title function_">findParent</span>(<span class="function">(<span class="params">p</span>)=&gt;</span>p.<span class="title function_">isObjectExpression</span>()));</span><br><span class="line">       <span class="comment">//path.findParent(function(p)&#123;return p.isObjectExpression()&#125;);</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//遍历returnstatement，然后向上找父级Path，当找到path对象类型为ObjectExpression,返回该path对象</span></span><br></pre></td></tr></table></figure>
<p>Path对象的findParent接收一个回调函数，在向上遍历每一个父级path时，会调用这个函数，并传入对应父级path对象作为参数，当该回调函数返回真值时，则将对应的父级path对象返回，</p>
<h4 id="path-find">path.find</h4>
<p>使用与findParent一致，只不过find查找范围包括当前节点，</p>
<h4 id="path-getFunctionParent">path.getFunctionParent</h4>
<p>向上查找与当前节点最接近的父函数，返回的也是path对象</p>
<h4 id="path-getStatementParent">path.getStatementParent</h4>
<p>向上遍历语法树直到找到语句父节点，例如，声明语句，return语句，if语句，which语句和while语句，返回的也是path对象，该方法从当前节点找，如果想要找到return语句父语句，从parentPath中调用</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">traverse</span>(ast,&#123;</span><br><span class="line">   <span class="title class_">ReturnStatement</span>(path)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(path.<span class="property">parentPath</span>.<span class="property">getStatementParent</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="父级path其他方法">父级path其他方法</h4>
<p>与之前介绍类似，如替换父节点path.parentPath.replaceWith(Node)</p>
<p>和删除父节点(path.parentPath.remove)</p>
</article><div class="post-copyright"><div class="post-copyright__title"><span class="post-copyright-info"><h>AST混淆与反混淆</h></span></div><div class="post-copyright__type"><span class="post-copyright-info"><a href="https://zxk1ng.github.io/posts/95017dfa.html">https://zxk1ng.github.io/posts/95017dfa.html</a></span></div><div class="post-copyright-m"><div class="post-copyright-m-info"><div class="post-copyright-a"><h>作者</h><div class="post-copyright-cc-info"><h>zxk1ng</h></div></div><div class="post-copyright-c"><h>发布于</h><div class="post-copyright-cc-info"><h>2025-01-15</h></div></div><div class="post-copyright-u"><h>更新于</h><div class="post-copyright-cc-info"><h>2025-01-15</h></div></div><div class="post-copyright-c"><h>许可协议</h><div class="post-copyright-cc-info"><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a rel="noopener" target="_blank" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></div></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/AST/"><div class="tags-punctuation"><svg class="faa-tada icon" style="height:1.1em;width:1.1em;fill:currentColor;position:relative;top:2px;margin-right:3px" aria-hidden="true"><use xlink:href="#icon-sekuaibiaoqian"></use></svg></div>AST</a><a class="post-meta__tags" href="/tags/JS%E9%80%86%E5%90%91/"><div class="tags-punctuation"><svg class="faa-tada icon" style="height:1.1em;width:1.1em;fill:currentColor;position:relative;top:2px;margin-right:3px" aria-hidden="true"><use xlink:href="#icon-sekuaibiaoqian"></use></svg></div>JS逆向</a><a class="post-meta__tags" href="/tags/%E7%88%AC%E8%99%AB/"><div class="tags-punctuation"><svg class="faa-tada icon" style="height:1.1em;width:1.1em;fill:currentColor;position:relative;top:2px;margin-right:3px" aria-hidden="true"><use xlink:href="#icon-sekuaibiaoqian"></use></svg></div>爬虫</a><a class="post-meta__tags" href="/tags/%E9%98%85%E8%AF%BB/"><div class="tags-punctuation"><svg class="faa-tada icon" style="height:1.1em;width:1.1em;fill:currentColor;position:relative;top:2px;margin-right:3px" aria-hidden="true"><use xlink:href="#icon-sekuaibiaoqian"></use></svg></div>阅读</a></div></div><link rel="stylesheet" href="/css/coin.css" media="defer" onload="this.media='all'"/><div class="post-reward"><button class="tip-button reward-button"><span class="tip-button__text">投喂作者</span><div class="coin-wrapper"><div class="coin"><div class="coin__middle"></div><div class="coin__back"></div><div class="coin__front"></div></div></div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat_reward.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/wechat_reward.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/zfb_reward.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/zfb_reward.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></button></div><audio id="coinAudio" src="https://npm.elemecdn.com/akilar-candyassets@1.0.36/audio/aowu.m4a"></audio><script defer="defer" src="/js/coin.js"></script><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/7e4211d.html"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://api.yimian.xyz/img?type=moe&amp;size=1920x1080" onerror="onerror=null;src='/assets/r2.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Android基础知识</div></div></a></div><div class="next-post pull-right"><a href="/posts/cf804d4e.html"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://api.yimian.xyz/img?type=moe&amp;size=1920x1080" onerror="onerror=null;src='/assets/r2.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">《App安全实战指南》阅读笔记</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/cf804d4e.html" title="《App安全实战指南》阅读笔记"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://api.yimian.xyz/img?type=moe&size=1920x1080" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2025-01-15</div><div class="title">《App安全实战指南》阅读笔记</div></div></a></div><div><a href="/posts/69766bbb.html" title="《第一行代码》阅读笔记"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://api.yimian.xyz/img?type=moe&size=1920x1080" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2025-01-15</div><div class="title">《第一行代码》阅读笔记</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><svg class="meta_icon" style="width:22px;height:22px;position:relative;top:5px"><use xlink:href="#icon-mulu1"></use></svg><span style="font-weight:bold">目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">AST混淆与解混淆</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">Web网站的调试与抓包分析</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Chrome%E5%BC%80%E5%8F%91%E8%80%85%E5%B7%A5%E5%85%B7"><span class="toc-text">Chrome开发者工具</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Elements%E9%9D%A2%E6%9D%BF"><span class="toc-text">Elements面板</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Console%E9%9D%A2%E6%9D%BF"><span class="toc-text">Console面板</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Source%E9%9D%A2%E6%9D%BF"><span class="toc-text">Source面板</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Application%E9%9D%A2%E6%9D%BF"><span class="toc-text">Application面板</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#js%E9%80%86%E5%90%91%E6%8A%80%E5%B7%A7"><span class="toc-text">js逆向技巧</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%AC%E5%9C%B0%E8%A6%86%E7%9B%96"><span class="toc-text">本地覆盖</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">爬虫与反爬虫</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82"><span class="toc-text">网络请求</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%91%E9%80%81%E8%AF%B7%E6%B1%82"><span class="toc-text">发送请求</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E8%A1%8C"><span class="toc-text">请求行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E5%A4%B4%E9%83%A8"><span class="toc-text">请求头部</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A9%BA%E8%A1%8C"><span class="toc-text">空行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E4%BD%93"><span class="toc-text">请求体</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E6%9E%90%E5%93%8D%E5%BA%94"><span class="toc-text">解析响应</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%93%8D%E5%BA%94%E8%A1%8C"><span class="toc-text">响应行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%93%8D%E5%BA%94%E5%A4%B4"><span class="toc-text">响应头</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%A9%BA%E8%A1%8C-2"><span class="toc-text">空行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%93%8D%E5%BA%94%E4%BD%93"><span class="toc-text">响应体</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB%E5%88%86%E7%B1%BB"><span class="toc-text">网络爬虫分类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E7%94%A8%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB"><span class="toc-text">通用网络爬虫</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%81%9A%E7%84%A6%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB"><span class="toc-text">聚焦网络爬虫</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A2%9E%E9%87%8F%E5%BC%8F%E7%BD%91%E7%BB%9C%E7%88%AC%E5%87%BA"><span class="toc-text">增量式网络爬出</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%B1%E5%B1%82%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB"><span class="toc-text">深层网络爬虫</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E5%86%99%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB"><span class="toc-text">编写网络爬虫</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#requests%E8%AF%B7%E6%B1%82%E5%BA%93%E4%BD%BF%E7%94%A8"><span class="toc-text">requests请求库使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bs4%E8%A7%A3%E6%9E%90%E5%BA%93%E4%BD%BF%E7%94%A8"><span class="toc-text">bs4解析库使用</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">常规反爬虫技巧</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Headers%E5%A4%B4%E9%83%A8%E6%A0%A1%E9%AA%8C"><span class="toc-text">Headers头部校验</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IP%E5%9C%B0%E5%9D%80%E8%AE%B0%E5%BD%95"><span class="toc-text">IP地址记录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Ajax%E5%BC%82%E6%AD%A5%E5%8A%A0%E8%BD%BD"><span class="toc-text">Ajax异步加载</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E4%BD%93%E5%8F%8D%E7%88%AC%E8%99%AB"><span class="toc-text">字体反爬虫</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%AA%8C%E8%AF%81%E7%A0%81%E5%8F%8D%E7%88%AC%E8%99%AB"><span class="toc-text">验证码反爬虫</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JS%E5%8F%82%E6%95%B0%E5%8A%A0%E5%AF%86"><span class="toc-text">JS参数加密</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JS%E5%8F%8D%E8%B0%83%E8%AF%95"><span class="toc-text">JS反调试</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#AST%E6%B7%B7%E6%B7%86%E5%8F%8D%E7%88%AC%E8%99%AB"><span class="toc-text">AST混淆反爬虫</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">混淆js手动逆向方法</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E7%BB%84%E6%B7%B7%E6%B7%86%E5%92%8C%E6%95%B0%E7%BB%84%E4%B9%B1%E5%BA%8F"><span class="toc-text">数组混淆和数组乱序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%8A%A0%E5%AF%86"><span class="toc-text">字符串加密</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%8A%B1%E6%8C%87%E4%BB%A4"><span class="toc-text">字符串花指令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#switch%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6%E5%B9%B3%E5%9D%A6%E5%8C%96"><span class="toc-text">switch流程控制平坦化</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">JS代码安全防护原理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E9%87%8F%E7%9A%84%E6%B7%B7%E6%B7%86"><span class="toc-text">常量的混淆</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E8%B1%A1%E5%B1%9E%E6%80%A7%E7%9A%84%E4%B8%A4%E7%A7%8D%E8%AE%BF%E9%97%AE%E6%96%B9%E5%BC%8F"><span class="toc-text">对象属性的两种访问方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%81%E5%85%AD%E8%BF%9B%E5%88%B6%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-text">十六进制字符串</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#unicode"><span class="toc-text">unicode</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84ASCII%E7%A0%81%E6%B7%B7%E6%B7%86"><span class="toc-text">字符串的ASCII码混淆</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E5%80%BC%E5%B8%B8%E9%87%8F%E5%8A%A0%E5%AF%86"><span class="toc-text">数值常量加密</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A2%9E%E5%8A%A0%E9%80%86%E5%90%91%E7%9A%84%E5%B7%A5%E4%BD%9C%E9%87%8F"><span class="toc-text">增加逆向的工作量</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E7%BB%84%E6%B7%B7%E6%B7%86"><span class="toc-text">数组混淆</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E7%BB%84%E4%B9%B1%E5%BA%8F"><span class="toc-text">数组乱序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8A%B1%E6%8C%87%E4%BB%A4"><span class="toc-text">花指令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jsfuck"><span class="toc-text">jsfuck</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B%E9%98%B2%E6%8A%A4%E5%8E%9F%E7%90%86"><span class="toc-text">代码执行流程防护原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%81%E7%A8%8B%E5%B9%B3%E5%9D%A6%E5%8C%96"><span class="toc-text">流程平坦化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%97%E5%8F%B7%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%B7%B7%E6%B7%86"><span class="toc-text">逗号表达式混淆</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E4%BB%A3%E7%A0%81%E9%98%B2%E6%8A%A4%E6%96%B9%E6%A1%88"><span class="toc-text">其他代码防护方案</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#eval%E5%8A%A0%E5%AF%86"><span class="toc-text">eval加密</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E5%AD%98%E7%88%86%E7%A0%B4"><span class="toc-text">内存爆破</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A3%80%E6%B5%8B%E4%BB%A3%E7%A0%81%E6%98%AF%E5%90%A6%E6%A0%BC%E5%BC%8F%E5%8C%96"><span class="toc-text">检测代码是否格式化</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-text">AST的API详解</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#AST%E5%85%A5%E9%97%A8"><span class="toc-text">AST入门</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#AST%E5%9F%BA%E6%9C%AC%E7%BB%93%E6%9E%84"><span class="toc-text">AST基本结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%9F%BA%E6%9C%AC%E7%BB%93%E6%9E%84"><span class="toc-text">代码基本结构</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Babel%E4%B8%AD%E7%9A%84%E7%BB%84%E4%BB%B6"><span class="toc-text">Babel中的组件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Babel%E7%9A%84%E8%A7%A3%E6%9E%90"><span class="toc-text">Babel的解析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Babel%E7%9A%84%E8%BD%AC%E5%8C%96"><span class="toc-text">Babel的转化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Babel%E7%9A%84%E7%94%9F%E6%88%90"><span class="toc-text">Babel的生成</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#parser%E4%B8%8Egenerator"><span class="toc-text">parser与generator</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#traverse%E4%B8%8Evisitor"><span class="toc-text">traverse与visitor</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#type%E7%BB%84%E4%BB%B6"><span class="toc-text">type组件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Path%E5%AF%B9%E8%B1%A1%E8%AF%A6%E8%A7%A3"><span class="toc-text">Path对象详解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Path%E4%B8%8ENode%E5%8C%BA%E5%88%AB"><span class="toc-text">Path与Node区别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Path%E4%B8%AD%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-text">Path中的方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%AD%90%E8%8A%82%E7%82%B9-path"><span class="toc-text">获取子节点&#x2F;path</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A4%E6%96%ADPath%E7%B1%BB%E5%9E%8B"><span class="toc-text">判断Path类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%8A%82%E7%82%B9%E8%BD%AC%E4%BB%A3%E7%A0%81"><span class="toc-text">节点转代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9B%BF%E6%8D%A2%E8%8A%82%E7%82%B9%E5%B1%9E%E6%80%A7"><span class="toc-text">替换节点属性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9B%BF%E6%8D%A2%E6%95%B4%E4%B8%AA%E8%8A%82%E7%82%B9"><span class="toc-text">替换整个节点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E8%8A%82%E7%82%B9"><span class="toc-text">删除节点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8F%92%E5%85%A5%E8%8A%82%E7%82%B9"><span class="toc-text">插入节点</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%88%B6%E7%BA%A7Path"><span class="toc-text">父级Path</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#path-findParent"><span class="toc-text">path.findParent</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#path-find"><span class="toc-text">path.find</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#path-getFunctionParent"><span class="toc-text">path.getFunctionParent</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#path-getStatementParent"><span class="toc-text">path.getStatementParent</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%88%B6%E7%BA%A7path%E5%85%B6%E4%BB%96%E6%96%B9%E6%B3%95"><span class="toc-text">父级path其他方法</span></a></li></ol></li></ol></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-color: transparent;"><div id="footer-wrap"><div id="ft"><div class="ft-item-1"><div class="t-top"><div class="t-t-l"><p class="ft-t t-l-t">格言🧬</p><div class="bg-ad"><div>再看看那个光点，它就在这里，这是家园，这是我们 —— 你所爱的每一个人，你认识的一个人，你听说过的每一个人，曾经有过的每一个人，都在它上面度过他们的一生✨</div><div class="btn-xz-box"><a class="btn-xz" target="_blank" rel="noopener" href="https://stellarium.org/">点击开启星辰之旅</a></div></div></div><div class="t-t-r"><p class="ft-t t-l-t">猜你想看💡</p><ul class="ft-links"><li><!--a(href='/posts/eec9786.html') 魔改指南--><a href="/personal/bb/">我的唠叨</a><a href="/box/nav/">网址导航</a></li><li><a href="/social/link/">我的朋友</a><a href="/comments/">留点什么</a></li><li><a href="/personal/about/">关于作者</a><a href="/archives/">文章归档</a></li><li><a href="/categories/">文章分类</a><a href="/tags/">文章标签</a></li><li><!--a(href='/box/Gallery/') 我的画廊--><!--a(href='/personal/bb/') 我的唠叨--></li><li><!--a(href='/site/time/') 建设进程--><!--a(href='/site/census/') 网站统计--></li></ul></div></div></div><div class="ft-item-2"><p class="ft-t">推荐友链⌛</p><div class="ft-img-group"><div class="img-group-item"><a href="https://zxk1ng.github.io/" title="zxk1ng"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/img.png" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="广告位招租"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="广告位招租"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="广告位招租"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="广告位招租"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="广告位招租"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="广告位招租"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div><div class="img-group-item"><a href="javascript:void(0)" title="广告位招租"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://lskypro.acozycotage.net/LightPicture/2022/12/65307a5828af6790.webp" alt=""/></a></div></div></div></div><div class="copyright"><span><b>&copy;2022-2025</b></span><span><b>&nbsp;&nbsp;By zxk1ng</b></span></div><div id="workboard"></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" title="博客框架为Hexo_v6.3.0"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Frame-Hexo-blue.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" title="主题版本Butterfly_v4.3.1"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Theme-Butterfly-6513df.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://vercel.com/" style="margin-inline:5px" title="本站采用多线部署，主线路托管于Vercel"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Hosted-Vercel-brightgreen.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://user.51.la/" style="margin-inline:5px" title="本站数据分析得益于51la技术支持"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/Analytics-51la-3db1eb.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://icp.gov.moe/?keyword=20226665" style="margin-inline:5px" title="本站已加入萌ICP豪华套餐，萌ICP备20226665号"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/萌ICP备-20226665-fe1384.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://bitiful.dogecast.com/buckets" style="margin-inline:5px" title="本网站经Service Worker分流至缤纷云对象存储"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src=" https://sourcebucket.s3.ladydaily.com/badge/Bucket-缤纷云-9c62da.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://www.netdun.net/" style="margin-inline:5px" title="本站使用网盾星球提供CDN加速与防护"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.ladydaily.com/badge/CDN-网盾星球-fff2cc.svg" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" title="本网站源码由Github提供存储仓库"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src=" https://sourcebucket.s3.ladydaily.com/badge/Source-Github-d021d6.svg" alt=""/></a></p></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><a class="icon-V hidden" onclick="switchNightMode()" title="浅色和深色模式转换"><svg width="25" height="25" viewBox="0 0 1024 1024"><use id="modeicon" xlink:href="#icon-moon"></use></svg></a><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button><button class="share" type="button" title="右键模式" onclick="changeMouseMode()"><i class="fas fa-mouse"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog right_side"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button class="share" type="button" title="分享链接" onclick="share()"><i class="fas fa-share-nodes"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i><span id="percent">0<span>%</span></span></button><button id="go-down" type="button" title="直达底部" onclick="btf.scrollToDest(document.body.scrollHeight, 500)"><i class="fas fa-arrow-down"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div class="js-pjax" id="rightMenu"><div class="rightMenu-group rightMenu-small"><a class="rightMenu-item" href="javascript:window.history.back();"><i class="fa fa-arrow-left"></i></a><a class="rightMenu-item" href="javascript:window.history.forward();"><i class="fa fa-arrow-right"></i></a><a class="rightMenu-item" href="javascript:window.location.reload();"><i class="fa fa-refresh"></i></a><a class="rightMenu-item" href="javascript:rmf.scrollToTop();"><i class="fa fa-arrow-up"></i></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-text"><a class="rightMenu-item" href="javascript:rmf.copySelect();"><i class="fa fa-copy"></i><span>复制</span></a><a class="rightMenu-item" href="javascript:window.open(&quot;https://www.baidu.com/s?wd=&quot;+window.getSelection().toString());window.location.reload();"><i class="fa fa-search"></i><span>百度搜索</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-too"><a class="rightMenu-item" href="javascript:window.open(window.getSelection().toString());window.location.reload();"><i class="fa fa-link"></i><span>转到链接</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-paste"><a class="rightMenu-item" href="javascript:rmf.paste()"><i class="fa fa-copy"></i><span>粘贴</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-post"><a class="rightMenu-item" href="#post-comment"><i class="fas fa-comment"></i><span>空降评论</span></a><a class="rightMenu-item" href="javascript:rmf.copyWordsLink()"><i class="fa fa-link"></i><span>复制本文地址</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-to"><a class="rightMenu-item" href="javascript:rmf.openWithNewTab()"><i class="fa fa-window-restore"></i><span>新窗口打开</span></a><a class="rightMenu-item" id="menu-too" href="javascript:rmf.open()"><i class="fa fa-link"></i><span>转到链接</span></a><a class="rightMenu-item" href="javascript:rmf.copyLink()"><i class="fa fa-copy"></i><span>复制链接</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-img"><a class="rightMenu-item" href="javascript:rmf.saveAs()"><i class="fa fa-download"></i><span>保存图片</span></a><a class="rightMenu-item" href="javascript:rmf.openWithNewTab()"><i class="fa fa-window-restore"></i><span>在新窗口打开</span></a><a class="rightMenu-item" href="javascript:rmf.copyLink()"><i class="fa fa-copy"></i><span>复制图片链接</span></a></div><div class="rightMenu-group rightMenu-line"><a class="rightMenu-item" href="javascript:randomPost()"><i class="fa fa-paper-plane"></i><span>随便逛逛</span></a><a class="rightMenu-item" href="javascript:switchNightMode();"><i class="fa fa-moon"></i><span>昼夜切换</span></a><a class="rightMenu-item" href="/personal/about/"><i class="fa fa-info-circle"></i><span>关于博客</span></a><a class="rightMenu-item" href="javascript:toggleWinbox();"><i class="fas fa-cog"></i><span>美化设置</span></a><a class="rightMenu-item" href="javascript:rmf.fullScreen();"><i class="fas fa-expand"></i><span>切换全屏</span></a><a class="rightMenu-item" href="javascript:window.print();"><i class="fa-solid fa-print"></i><span>打印页面</span></a></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.staticfile.org/fancyapps-ui/4.0.31/fancybox.umd.min.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/instant.page/5.1.0/instantpage.min.js" type="module"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/vanilla-lazyload/17.3.1/lazyload.iife.min.js"></script><script src="/js/search/local-search.js"></script><script async="async">var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())
setTimeout(function(){preloader.endLoading();}, 5000);
document.getElementById('loading-box').addEventListener('click',()=> {preloader.endLoading()})</script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>(()=>{
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: '',
      region: '',
      onCommentLoaded: function () {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: '',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      countELement.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const runFn = () => {
    init()
    
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') {
      setTimeout(runFn,0)
      return
    } 
    getScript('https://cdn.staticfile.org/twikoo/1.6.8/twikoo.all.min.js').then(runFn)
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><script src="https://cdn.staticfile.org/jquery/3.6.3/jquery.min.js"></script><script async src="https://cdn1.tianli0.top/npm/vue@2.6.14/dist/vue.min.js"></script><script async src="https://cdn1.tianli0.top/npm/element-ui@2.15.6/lib/index.js"></script><script async src="https://cdn.bootcdn.net/ajax/libs/clipboard.js/2.0.11/clipboard.min.js"></script><script defer type="text/javascript" src="https://cdn1.tianli0.top/npm/sweetalert2@8.19.0/dist/sweetalert2.all.js"></script><script async src="//npm.elemecdn.com/pace-js@1.2.4/pace.min.js"></script><script defer src="https://cdn1.tianli0.top/gh/nextapps-de/winbox/dist/winbox.bundle.min.js"></script><script async src="//at.alicdn.com/t/c/font_3586335_hsivh70x0fm.js"></script><script async src="//at.alicdn.com/t/c/font_3636804_gr02jmjr3y9.js"></script><script async src="//at.alicdn.com/t/c/font_3612150_kfv55xn3u2g.js"></script><script async src="https://cdn.wpon.cn/2022-sucai/Gold-ingot.js"></script><canvas id="universe"></canvas><canvas id="snow"></canvas><script defer src="/js/fomal.js"></script><link rel="stylesheet" href="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/aplayer/1.10.1/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://lf6-cdn-tos.bytecdntp.com/cdn/expire-1-M/aplayer/1.10.1/APlayer.min.js"></script><script src="https://cdn1.tianli0.top/npm/js-heo@1.0.12/metingjs/Meting.min.js"></script><script src="https://lib.baomitu.com/pjax/0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show","#web_bg",".js-pjax","#bibi","body > title","#app","#tag-echarts","#posts-echart","#categories-echarts"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_swiper_injector_config(){
    var parent_div_git = document.getElementById('recent-posts');
    var item_html = '<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/e65d2ab6.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://api.yimian.xyz/img?type=moe&amp;size=1920x1080" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-01-15</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/e65d2ab6.html&quot;);" href="javascript:void(0);" alt="">刷机与脱壳机入门</a><div class="blog-slider__text">🐱刷机与部分脱壳机、脱壳点的入门学习</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/e65d2ab6.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/69766bbb.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://api.yimian.xyz/img?type=moe&amp;size=1920x1080" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-01-15</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/69766bbb.html&quot;);" href="javascript:void(0);" alt="">《第一行代码》阅读笔记</a><div class="blog-slider__text">🍓阅读《第一行代码》记录的一些小东西</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/69766bbb.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/cf804d4e.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://api.yimian.xyz/img?type=moe&amp;size=1920x1080" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-01-15</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/cf804d4e.html&quot;);" href="javascript:void(0);" alt="">《App安全实战指南》阅读笔记</a><div class="blog-slider__text">🥧阅读《App安全实战指南》记录的一些小东西</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/cf804d4e.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/5324751f.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://api.yimian.xyz/img?type=moe&amp;size=1920x1080" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-01-15</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/5324751f.html&quot;);" href="javascript:void(0);" alt="">wechat简单逆向</a><div class="blog-slider__text">🥧对旧版本微信App的基本功能进行逆向分析</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/5324751f.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/b00b5fdb.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://api.yimian.xyz/img?type=moe&amp;size=1920x1080" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-01-15</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/b00b5fdb.html&quot;);" href="javascript:void(0);" alt="">frida与Objection</a><div class="blog-slider__text">🥝frida与objection基本操作整理与归纳</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/b00b5fdb.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/947764cb.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://api.yimian.xyz/img?type=moe&amp;size=1920x1080" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-01-15</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/947764cb.html&quot;);" href="javascript:void(0);" alt="">Xposed框架</a><div class="blog-slider__text">🐕Xposed Hook框架的基本操作整理与归纳</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/947764cb.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/f416437f.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://api.yimian.xyz/img?type=moe&amp;size=1920x1080" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-01-15</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/f416437f.html&quot;);" href="javascript:void(0);" alt="">App安全分析指南</a><div class="blog-slider__text">🍅对网上一些关于移动安全测试文章的整理与归纳</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/f416437f.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/466ed760.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://api.yimian.xyz/img?type=moe&amp;size=1920x1080" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-01-15</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/466ed760.html&quot;);" href="javascript:void(0);" alt="">Unidbg</a><div class="blog-slider__text">♥Unidbg基本操作的整理与归纳</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/466ed760.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/f0867805.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://api.yimian.xyz/img?type=moe&amp;size=1920x1080" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-01-15</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/f0867805.html&quot;);" href="javascript:void(0);" alt="">NDK学习</a><div class="blog-slider__text">🍑NDK开发基本操作的记录</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/f0867805.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/be4930f3.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://api.yimian.xyz/img?type=moe&amp;size=1920x1080" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-01-15</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/be4930f3.html&quot;);" href="javascript:void(0);" alt="">Android抓包</a><div class="blog-slider__text">🍍Android抓包技术的整理与归纳</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/be4930f3.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/7e4211d.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://api.yimian.xyz/img?type=moe&amp;size=1920x1080" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-01-15</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/7e4211d.html&quot;);" href="javascript:void(0);" alt="">Android基础知识</a><div class="blog-slider__text">🍇Android逆向学习的前置知识</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/7e4211d.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" onclick="pjax.loadUrl(&quot;posts/95017dfa.html&quot;);" href="javascript:void(0);" alt=""><img width="48" height="48" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://api.yimian.xyz/img?type=moe&amp;size=1920x1080" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2025-01-15</span><a class="blog-slider__title" onclick="pjax.loadUrl(&quot;posts/95017dfa.html&quot;);" href="javascript:void(0);" alt="">AST混淆与反混淆</a><div class="blog-slider__text">🥒阅读《反爬虫AST原理与还原混淆实战》记录的一些小东西</div><a class="blog-slider__button" onclick="pjax.loadUrl(&quot;posts/95017dfa.html&quot;);" href="javascript:void(0);" alt="">详情       </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>';
    console.log('已挂载butterfly_swiper')
    parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  var elist = 'undefined'.split(',');
  var cpage = location.pathname;
  var epage = '/';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_swiper_injector_config();
  }
  else if (epage === cpage){
    butterfly_swiper_injector_config();
  }
  </script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script><script data-pjax src="https://npm.elemecdn.com/hexo-filter-gitcalendar/lib/gitcalendar.js"></script><script data-pjax>
  function gitcalendar_injector_config(){
      var parent_div_git = document.getElementById('gitZone');
      var item_html = '<div class="recent-post-item" id="gitcalendarBar" style="width:100%;height:auto;padding:10px;"><style>#git_container{min-height: 320px}@media screen and (max-width:650px) {#git_container{min-height: 0px}}</style><div id="git_loading" style="width:10%;height:100%;margin:0 auto;display: block;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animatetransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animatetransform></path></svg><style>#git_container{display: none;}</style></div><div id="git_container"></div></div>';
      parent_div_git.insertAdjacentHTML("afterbegin",item_html)
      console.log('已挂载gitcalendar')
      }

    if( document.getElementById('gitZone') && (location.pathname ==='/site/census/'|| '/site/census/' ==='all')){
        gitcalendar_injector_config()
        GitCalendarInit("/api?null",['#d9e0df', '#c6e0dc', '#a8dcd4', '#9adcd2', '#89ded1', '#77e0d0', '#5fdecb', '#47dcc6', '#39dcc3', '#1fdabe', '#00dab9'],'null')
    }
  </script><div class="js-pjax"><script async="async">var arr = document.getElementsByClassName('recent-post-item');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '2s');
    arr[i].setAttribute('data-wow-delay', '200ms');
    arr[i].setAttribute('data-wow-offset', '30');
    arr[i].setAttribute('data-wow-iteration', '1');
  }</script><script async="async">var arr = document.getElementsByClassName('card-widget');
for(var i = 0;i<arr.length;i++){
    arr[i].classList.add('wow');
    arr[i].classList.add('animate__zoomIn');
    arr[i].setAttribute('data-wow-duration', '2s');
    arr[i].setAttribute('data-wow-delay', '200ms');
    arr[i].setAttribute('data-wow-offset', '30');
    arr[i].setAttribute('data-wow-iteration', '1');
  }</script></div><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow_init.js"></script><!-- hexo injector body_end end --></body></html>